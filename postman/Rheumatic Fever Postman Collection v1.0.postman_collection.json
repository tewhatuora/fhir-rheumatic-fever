{
	"info": {
		"_postman_id": "3af8ca38-2002-4631-a60b-4a9a1051ed5b",
		"name": "Rheumatic Fever Postman Collection v1.0",
		"description": "**CHANGELOG**\n\n**May 21 2024: v0.4.0 - RF phase 2 updates / tranche 1**\n\nDefinitional / seed resources\n\n- Expanded seed **LeadProvidersGroup** `CareTeam` now includes all RF secondary prevention provider HPI orgs.\n    \n\nNew example instances\n\n- **diagnosis encounter,** created by a new step in the _Register Patient_ folder - demonstrates the new diagnosis summary items (D3-D10)\n    \n\nUpdated example instances\n\n- _Condition-SevereRfConditionExample_ - latest version illustrates\n    \n    - **date of diagnosis** (recordedDate)\n        \n    - **symptom status at diagnosis** (new extension)\n        \n    - **symptom onset date**\n        \n- _SecondaryProphylaxisCareTeam_ (Taranaki RF service now ref'd by correct HPI org Id)\n    \n- _SecondaryProphylaxisAppointment-September-Booked_ now reflects encounter to occur at shared care provider (Taranaki).\n    \n- _MedicationRequest-PlannedBenzathineMedicationWithLignocaine_ the planned medication in the careplan now shows planned medication with benzathine AND lignocaine for pain relief\n    \n- _Bundle-SecondaryProphylaxisAugustEncounterBundle_ now demonstrates lignocaine pain relief med using a contained MedicationStatement instance\n    \n\n**v0.4.0a** fixed missing identifier '_RheumaticFeverLeadProviderGroup'_ in canonical CareTeam instance\n\n**June 21 2024: v0.4.3**\n\n- Updated seed Questionnaires to match IGv0.4.3\n    \n- Updated all example instances to match IGv0.4.3 (EXCEPT for Consent instances which remain unchanged for now)\n    \n\n**August 8 2024: v0.4.7**\n\n- Updated all seed resources and example instances per phase 2 updates and using the IG at its official published location [https://fhir-ig.digital.health.nz/rheumatic-fever/index.html](https://fhir-ig.digital.health.nz/rheumatic-fever/index.html)\n    \n\n**August 12 2024: v0.4.8**\n\n- national system (rfccs) identifiers, as sliced in profiles, in example instances updated to align to forthcoming system namespace standard\n    \n- eSAM address id of patient's home address now uses the new standard system namespace uri.\n    \n\n**August 12 2024: v0.4.8a**\n\n- fixed bug in Consent data.reference linking\n    \n- fixed update bug where SP appointment was being overwritten by dental appointment\n    \n- added canned queries to show retrieving RF instances by `_tag` and `_profile`\n    \n- updated XXX example that demonstrates 'other' relationshiptype\n    \n\n**September 20 2024: v0.5**\n\n- All canonical Urls updated for the Implementation Guide published at the official location [https://fhir-ig.digital.health.nz/rheumatic-fever/index.html](https://fhir-ig.digital.health.nz/rheumatic-fever/index.html)\n    \n- Updated example Request-Context supplied in all API requests (root folder script)\n    \n- Removed the canonical Secondary RF Providers `CareTeam` instance creation (no longer needed)\n    \n- Added alternate API authentication with scopes and audiences issued by HNZ's Keycloak IdP\n    \n\n**September 25 2024: v1.0**\n\n- final version for RF phase 2 testing",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "21888815"
	},
	"item": [
		{
			"name": "Authorise",
			"item": [
				{
					"name": "Get scoped access token from Keycloak",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = pm.response.json();",
									"",
									"pm.environment.set(\"OAUTH_TOKEN\", jsonData['access_token']);",
									"",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{OAUTH_TOKEN}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "grant_type",
									"value": "client_credentials",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "{{KEYCLOAK_CLIENT_ID}}",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "{{KEYCLOAK_CLIENT_SECRET}}",
									"type": "text"
								},
								{
									"key": "scope",
									"value": "system/*.crus system/Appointment.crus?_tag=https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz system/Bundle.crus system/CarePlan.crus system/CareTeam.crus system/Condition.crus system/Consent.crus system/Encounter.crus?_tag=https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz system/Medication.crus system/MedicationRequest.crus system/MedicationStatement.crus?_tag=https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz system/Observation.crus system/Patient.crus system/Questionnaire.crus system/QuestionnaireResponse.crus?_tag=https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{AUTH_URL_KEYCLOAK}}",
							"host": [
								"{{AUTH_URL_KEYCLOAK}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "OR: Get legacy access token from Cognito",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"",
									"pm.environment.set(\"OAUTH_TOKEN\", jsonData['access_token']);",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "grant_type",
									"value": "client_credentials",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "{{COGNITO_CLIENT_ID}}",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "{{COGNITO_CLIENT_SECRET}}",
									"type": "text"
								},
								{
									"key": "scope",
									"value": "scope/cinc",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{AUTH_URL}}",
							"host": [
								"{{AUTH_URL}}"
							]
						}
					},
					"response": []
				}
			],
			"description": "Use to obtain an access token to perform requests on FHIR resources"
		},
		{
			"name": "(SANDBOX mode only) Clear sandbox",
			"item": [
				{
					"name": "0.1 Reset Sandbox",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "x-api-key",
								"value": "{{API_KEY}}",
								"type": "default"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{API_URL}}/_internal/reset",
							"host": [
								"{{API_URL}}"
							],
							"path": [
								"_internal",
								"reset"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Environment seeding seed (DEV/TEST only)",
			"item": [
				{
					"name": "Rheumatic Fever Questionnaires",
					"item": [
						{
							"name": "PatientMedicationAllergyQuestionnaire (PMA)",
							"item": [
								{
									"name": "Create Questionnaire (in DEV/TEST)",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"if (pm.response.code === 201) {\r",
													"    // obtain payload and id as assigned by the server for updating the resource URL in the next step \r",
													"\r",
													"    // get payload as created \r",
													"    const Q = pm.response.json();\r",
													"    pm.environment.set(\"T-Q\", JSON.stringify(Q));\r",
													"\r",
													"    // grab the id\r",
													"    const Qid = pm.response.json().id;\r",
													"    pm.environment.set(\"T-Qid\", pm.response.json().id);      \r",
													"    \r",
													"    // Both the above environment vars are relied on by the next step to update the resource URL\r",
													"}\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"// update CURRENT_DATE element\r",
													"let date = new Date();\r",
													"pm.variables.set(\"CURRENT_DATE\", date.toISOString().slice(0, 10));\r",
													"\r",
													"// Before we create, check if there is already a resource with the well-known identifier\r",
													"// Questionnaire?url={{OfficialUrl}}\r",
													"\r",
													"let url = `${pm.environment.get(\"API_URL\")}/Questionnaire?url=` + `${pm.environment.get(\"OfficialUrl\")}`\r",
													"\r",
													"console.log( \"Checking for well-known resource at \" + url );\r",
													"\r",
													"const getRequest = {\r",
													"  url,\r",
													"  method: 'GET',\r",
													"  header: {\r",
													"    'Authorization': pm.environment.get(\"OAUTH_TOKEN\"),\r",
													"    'x-api-key': pm.environment.get(\"API_KEY\"),\r",
													"    'Request-Context': pm.environment.get(\"REQUEST-CONTEXT\"),\r",
													"  }\r",
													"};\r",
													"\r",
													"const bundle = pm.sendRequest( getRequest, (error, response) => {\r",
													"      if (error) {\r",
													"            console.log(error);\r",
													"         } else {\r",
													"            // console.log(response.json());\r",
													"\r",
													"            if (response.json().total >= 1) {\r",
													"                 throw new Error(\"Well-known resource already exists at \" + url);\r",
													"           } \r",
													"\r",
													"         }\r",
													"    }\r",
													");\r",
													"\r",
													"\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n  \"resourceType\" : \"Questionnaire\",\r\n  \"id\" : \"PatientMedicationAllergyQuestionnaire\",\r\n  \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/PatientMedicationAllergyQuestionnaire\",\r\n  \"identifier\" : [{\r\n    \"use\" : \"official\",\r\n    \"value\" : \"PatientMedicationAllergyQuestionnaire\",\r\n    \"period\" : {\r\n      \"start\" : \"2023-10-16\"\r\n    }\r\n  }],\r\n  \"version\" : \"1.0.0\",\r\n  \"name\" : \"PatientMedicationAllergyQuestionnaire\",\r\n  \"title\" : \"Secondary prophylaxis medication allergy questionnaire\",\r\n  \"status\" : \"draft\",\r\n  \"experimental\" : false,\r\n  \"subjectType\" : [\"Patient\"],\r\n  \"date\" : \"2024-08-07\",\r\n  \"publisher\" : \"Te Whatu Ora\",\r\n  \"contact\" : [{\r\n    \"name\" : \"Te Whatu Ora\",\r\n    \"telecom\" : [{\r\n      \"system\" : \"url\",\r\n      \"value\" : \"https://www.tewhatuora.govt.nz/\"\r\n    },\r\n    {\r\n      \"system\" : \"email\",\r\n      \"value\" : \"integration@tewhatuora.govt.nz\"\r\n    }]\r\n  },\r\n  {\r\n    \"name\" : \"HNZ Integration Team\",\r\n    \"telecom\" : [{\r\n      \"system\" : \"email\",\r\n      \"value\" : \"integration@tewhatuora.govt.nz\",\r\n      \"use\" : \"work\"\r\n    }]\r\n  }],\r\n  \"description\" : \"Describes any known patient allergies to medications used in rheumatic fever secondary prophylaxis\",\r\n  \"purpose\" : \"Gathers information which is specific to rheumatic fever secondary prophylaxis treatment in New Zealand\",\r\n  \"item\" : [{\r\n    \"linkId\" : \"page1\",\r\n    \"prefix\" : \"page1\",\r\n    \"text\" : \"Please complete this questionnaire to record a patient's allergies to secondary prophylaxis medication.\",\r\n    \"type\" : \"display\"\r\n  },\r\n  {\r\n    \"linkId\" : \"MedicationAllergies\",\r\n    \"prefix\" : \"1)\",\r\n    \"text\" : \"Medication allergies? (Yes/No/Unknown)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerValueSet\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/ValueSet/nz-questionnaireresponse-qualifiedyesno-code\",\r\n    \"initial\" : [{\r\n      \"valueCoding\" : {\r\n        \"system\" : \"http://snomed.info/sct\",\r\n        \"code\" : \"261665006\",\r\n        \"display\" : \"Unknown (qualifier value)\"\r\n      }\r\n    }]\r\n  },\r\n  {\r\n    \"extension\" : [{\r\n      \"url\" : \"http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-preferredTerminologyServer\",\r\n      \"valueUrl\" : \"https://nzhts.digital.health.nz/fhir\"\r\n    }],\r\n    \"linkId\" : \"AllergyDetails\",\r\n    \"prefix\" : \"1.1\",\r\n    \"text\" : \"If yes, select which substances apply\",\r\n    \"type\" : \"choice\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"MedicationAllergies\",\r\n      \"operator\" : \"=\",\r\n      \"answerCoding\" : {\r\n        \"system\" : \"http://snomed.info/sct\",\r\n        \"code\" : \"373066001\",\r\n        \"display\" : \"Yes (qualifier value)\"\r\n      }\r\n    }],\r\n    \"required\" : true,\r\n    \"repeats\" : true,\r\n    \"answerValueSet\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/ValueSet/rf-medicationallergy-code\"\r\n  }]\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Questionnaire",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Questionnaire"
											]
										}
									},
									"response": []
								},
								{
									"name": "Get Questionnaire at official Url",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"if(pm.response.json().total === 1){\r",
													"  const id = pm.response.json().entry[0].resource.id;\r",
													"  pm.environment.set(\"T-Qid\", id);\r",
													"}\r",
													"\r",
													"if(pm.response.json().total === 0){\r",
													"    throw new Error (\"Questionnaire resource does not exist with official URL [\" + pm.environment.get(\"OfficialUrl\") + \"].  Please run Create step in this folder to create.\")\r",
													"}\r",
													"\r",
													"if(pm.response.json().total > 1){\r",
													"    throw new Error(\"More than 1 result returned. This indicates duplicate Questionanire resources with official URL [\" + pm.environment.get(\"OfficialUrl\") + \"] present.  Please fix.\")\r",
													"}"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Questionnaire?url={{OfficialUrl}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Questionnaire"
											],
											"query": [
												{
													"key": "url",
													"value": "{{OfficialUrl}}"
												}
											]
										}
									},
									"response": []
								}
							],
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"type": "text/javascript",
										"exec": [
											"pm.environment.set(\"OfficialUrl\",",
											"\t'https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/PatientMedicationAllergyQuestionnaire');"
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								}
							]
						},
						{
							"name": "PatientWhanauGoalsPreferencesQuestionnaire (PWGOAL)",
							"item": [
								{
									"name": "Create Questionnaire (in DEV/TEST)",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"if (pm.response.code === 201) {\r",
													"    // obtain payload and id as assigned by the server for updating the resource URL in the next step \r",
													"\r",
													"    // get payload as created \r",
													"    const Q = pm.response.json();\r",
													"    pm.environment.set(\"T-Q\", JSON.stringify(Q));\r",
													"\r",
													"    // grab the id\r",
													"    const Qid = pm.response.json().id;\r",
													"    pm.environment.set(\"T-Qid\", pm.response.json().id);      \r",
													"    \r",
													"    // Both the above environment vars are relied on by the next step to update the resource URL\r",
													"}\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"// update CURRENT_DATE element\r",
													"let date = new Date();\r",
													"pm.variables.set(\"CURRENT_DATE\", date.toISOString().slice(0, 10));\r",
													"\r",
													"// Before we create, check if there is already a resource with the well-known identifier\r",
													"//   Questionnaire?url={{OfficialUrl}}\r",
													"\r",
													"let url = `${pm.environment.get(\"API_URL\")}/Questionnaire?url=` + `${pm.environment.get(\"OfficialUrl\")}`\r",
													"\r",
													"console.log( \"Checking for well-known resource at \" + url );\r",
													"\r",
													"const getRequest = {\r",
													"  url,\r",
													"  method: 'GET',\r",
													"  header: {\r",
													"    'Authorization': pm.environment.get(\"OAUTH_TOKEN\"),\r",
													"    'x-api-key': pm.environment.get(\"API_KEY\"),\r",
													"    'Request-Context': pm.environment.get(\"REQUEST-CONTEXT\"),\r",
													"  }\r",
													"};\r",
													"\r",
													"const bundle = pm.sendRequest( getRequest, (error, response) => {\r",
													"      if (error) {\r",
													"            console.log(error);\r",
													"         } else {\r",
													"            // console.log(response.json());\r",
													"\r",
													"            if (response.json().total >= 1) {\r",
													"                 throw new Error(\"Well-known resource already exists at \" + url);\r",
													"           } \r",
													"\r",
													"         }\r",
													"    }\r",
													");\r",
													"\r",
													"\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n  \"resourceType\" : \"Questionnaire\",\r\n  \"id\" : \"PatientWhanauGoalsPreferencesQuestionnaire\",\r\n  \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/PatientWhanauGoalsPreferencesQuestionnaire\",\r\n  \"identifier\" : [{\r\n    \"use\" : \"official\",\r\n    \"value\" : \"PatientWhanauGoalsPreferencesQuestionnaire\",\r\n    \"period\" : {\r\n      \"start\" : \"2023-10-16\"\r\n    }\r\n  }],\r\n  \"version\" : \"1.0.0\",\r\n  \"name\" : \"PatientWhanauGoalsPreferencesQuestionnaire\",\r\n  \"title\" : \"Patient & whanau goals and preferences questionnaire\",\r\n  \"status\" : \"draft\",\r\n  \"experimental\" : false,\r\n  \"subjectType\" : [\"Patient\"],\r\n  \"date\" : \"2023-10-16\",\r\n  \"publisher\" : \"Te Whatu Ora\",\r\n  \"contact\" : [{\r\n    \"name\" : \"Te Whatu Ora\",\r\n    \"telecom\" : [{\r\n      \"system\" : \"url\",\r\n      \"value\" : \"https://www.tewhatuora.govt.nz/\"\r\n    },\r\n    {\r\n      \"system\" : \"email\",\r\n      \"value\" : \"integration@tewhatuora.govt.nz\"\r\n    }]\r\n  },\r\n  {\r\n    \"name\" : \"HNZ Integration Team\",\r\n    \"telecom\" : [{\r\n      \"system\" : \"email\",\r\n      \"value\" : \"integration@tewhatuora.govt.nz\",\r\n      \"use\" : \"work\"\r\n    }]\r\n  }],\r\n  \"description\" : \"Gathers patient and whanau preferences and goals for rheumatic fever care\",\r\n  \"purpose\" : \"Gathers patient and whanau preferences and goals for rheumatic fever care\",\r\n  \"item\" : [{\r\n    \"linkId\" : \"page1\",\r\n    \"prefix\" : \"page1\",\r\n    \"text\" : \"Please complete this questionnaire to record goals and preferences of a patient or their whanau in relation to rheumatic fever prevention treatment.\",\r\n    \"type\" : \"display\"\r\n  },\r\n  {\r\n    \"linkId\" : \"ImportantToMe\",\r\n    \"prefix\" : \"1)\",\r\n    \"text\" : \"What things that are important to me and my family that support my health and wellbeing? (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"WhanauInvolvement\",\r\n    \"prefix\" : \"2)\",\r\n    \"text\" : \"How would I like my whanau and support persons to be involved? (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"BestWayToCommunicate\",\r\n    \"prefix\" : \"3)\",\r\n    \"text\" : \"The best way to communicate with me is…? (choose one)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"phone call\"\r\n    },\r\n    {\r\n      \"valueString\" : \"text message\"\r\n    },\r\n    {\r\n      \"valueString\" : \"email\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"AppointmentsContact\",\r\n    \"prefix\" : \"4)\",\r\n    \"text\" : \"I know who to contact about my appointments? (choose one)\",\r\n    \"type\" : \"boolean\",\r\n    \"required\" : false,\r\n    \"item\" : [{\r\n      \"extension\" : [{\r\n        \"url\" : \"http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl\",\r\n        \"valueCodeableConcept\" : {\r\n          \"coding\" : [{\r\n            \"system\" : \"http://hl7.org/fhir/questionnaire-item-control\",\r\n            \"code\" : \"help\",\r\n            \"display\" : \"Help-Button\"\r\n          }],\r\n          \"text\" : \"Help-Button\"\r\n        }\r\n      }],\r\n      \"linkId\" : \"AppointmentsContactHelp\",\r\n      \"text\" : \"I understand who I should phone or text if I need to change my appointments, OR if I am going to be away, OR if I have questions.\",\r\n      \"type\" : \"display\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"PreferredAppointmentsLocation\",\r\n    \"prefix\" : \"5)\",\r\n    \"text\" : \"What location do I prefer to receive injected antibiotics at? (choose one)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"School\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Home\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Work\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Clinic\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Other\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"InjectionLocationDetail\",\r\n    \"prefix\" : \"6)\",\r\n    \"text\" : \"More detail about this location (eg. at school during term time, but at home with Dad if out of term time)? (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"ImportantDuringInjectionVisits\",\r\n    \"prefix\" : \"7)\",\r\n    \"text\" : \"What things that are important to me during my injection visits eg. karakia, kaiawhina support? (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"InjectionVisitsNoNos\",\r\n    \"prefix\" : \"8)\",\r\n    \"text\" : \"What things don't work well for me during my injection visits? (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"MakingInjectionsComfortable\",\r\n    \"prefix\" : \"9)\",\r\n    \"text\" : \"What things do I like to have with my injections to make them more comfortable? (multiple choice)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : true,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"Lignocaine\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Ice pack\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Buzzy bee\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Numbing cream (Emla)\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Numbing spray\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Distraction\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Very slow injection\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"InjectionOtherComfort\",\r\n    \"prefix\" : \"10)\",\r\n    \"text\" : \"What other things make my injections more comfortable? (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"MedsPreferredSupplyMethod\",\r\n    \"prefix\" : \"11)\",\r\n    \"text\" : \"I would prefer to get my oral antibiotic medicines from? (choose one)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"GP prescription\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Monthly visit from a nurse\"\r\n    },\r\n    {\r\n      \"valueString\" : \"3 monthly visit from a nurse\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Pick-up from a pharmacy\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Other\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"MedsSupplyOtherDetail\",\r\n    \"prefix\" : \"11.1)\",\r\n    \"text\" : \"If other, enter details\",\r\n    \"type\" : \"text\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"MedsPreferredSupplyMethod\",\r\n      \"operator\" : \"=\",\r\n      \"answerString\" : \"Other\"\r\n    }],\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"EasierToGetToAppointments\",\r\n    \"prefix\" : \"12)\",\r\n    \"text\" : \"What things make it easier for me to get to hospital appointments? (multiple choice)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : true,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"Support with transport\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Morning appointments\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Afternoon appointments\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Choice of clinic days\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Cultural support\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Other\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"HospitalAppointmentsImportant\",\r\n    \"prefix\" : \"13)\",\r\n    \"text\" : \"More detail about the things that are important to me about hospital appointments (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"HospitalAppointmentsNoNos\",\r\n    \"prefix\" : \"14)\",\r\n    \"text\" : \"Things that don't work well for me about hospital appointments (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"SupportGettingToHospitalAppointments\",\r\n    \"prefix\" : \"15)\",\r\n    \"text\" : \"Do I need support getting to and from hospital appointment? (choose one)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"Yes - always\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Yes - sometimes, please check each time\"\r\n    },\r\n    {\r\n      \"valueString\" : \"No\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Not sure\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Other\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"HospitalAppointmentsTransportSupport\",\r\n    \"prefix\" : \"question 16\",\r\n    \"text\" : \"Which transport support option do I need? (choose one)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"Taxi vouchers\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Top up on public transport card\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Hospital to provide transport\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Other\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"HospitalAppointmentsTransportOtherDetail\",\r\n    \"prefix\" : \"question 17\",\r\n    \"text\" : \"What other details are there about getting to hospital appointments? (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  }]\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Questionnaire",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Questionnaire"
											]
										}
									},
									"response": []
								},
								{
									"name": "Get Questionnaire at official Url",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"if(pm.response.json().total === 1){\r",
													"  const id = pm.response.json().entry[0].resource.id;\r",
													"  pm.environment.set(\"T-Qid\", id);\r",
													"}\r",
													"\r",
													"if(pm.response.json().total === 0){\r",
													"    throw new Error (\"Questionnaire resource does not exist with official URL [\" + pm.environment.get(\"OfficialUrl\") + \"].  Please run Create step in this folder to create.\")\r",
													"}\r",
													"\r",
													"if(pm.response.json().total > 1){\r",
													"    throw new Error(\"More than 1 result returned. This indicates duplicate Questionanire resources with official URL [\" + pm.environment.get(\"OfficialUrl\") + \"] present.  Please fix.\")\r",
													"}"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Questionnaire?url={{OfficialUrl}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Questionnaire"
											],
											"query": [
												{
													"key": "url",
													"value": "{{OfficialUrl}}"
												}
											]
										}
									},
									"response": []
								}
							],
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"type": "text/javascript",
										"exec": [
											"pm.environment.set(\"OfficialUrl\",",
											"\t'https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/PatientWhanauGoalsPreferencesQuestionnaire');"
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								}
							]
						},
						{
							"name": "MedicationsAndFollowUpGuidanceQuestionnaire (MFUG)",
							"item": [
								{
									"name": "Create Questionnaire (in DEV/TEST)",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"if (pm.response.code === 201) {\r",
													"    // obtain payload and id as assigned by the server for updating the resource URL in the next step \r",
													"\r",
													"    // get payload as created \r",
													"    const Q = pm.response.json();\r",
													"    pm.environment.set(\"T-Q\", JSON.stringify(Q));\r",
													"\r",
													"    // grab the id\r",
													"    const Qid = pm.response.json().id;\r",
													"    pm.environment.set(\"T-Qid\", pm.response.json().id);      \r",
													"    \r",
													"    // Both the above environment vars are relied on by the next step to update the resource URL\r",
													"}\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"// update CURRENT_DATE element\r",
													"let date = new Date();\r",
													"pm.variables.set(\"CURRENT_DATE\", date.toISOString().slice(0, 10));\r",
													"\r",
													"// Before we create, check if there is already a resource with the well-known identifier\r",
													"// Questionnaire?url={{OfficialUrl}}\r",
													"\r",
													"let url = `${pm.environment.get(\"API_URL\")}/Questionnaire?url=` + `${pm.environment.get(\"OfficialUrl\")}`\r",
													"\r",
													"console.log( \"Checking for well-known resource at \" + url );\r",
													"\r",
													"const getRequest = {\r",
													"  url,\r",
													"  method: 'GET',\r",
													"  header: {\r",
													"    'Authorization': pm.environment.get(\"OAUTH_TOKEN\"),\r",
													"    'x-api-key': pm.environment.get(\"API_KEY\"),\r",
													"    'Request-Context': pm.environment.get(\"REQUEST-CONTEXT\"),\r",
													"  }\r",
													"};\r",
													"\r",
													"const bundle = pm.sendRequest( getRequest, (error, response) => {\r",
													"      if (error) {\r",
													"            console.log(error);\r",
													"         } else {\r",
													"            // console.log(response.json());\r",
													"\r",
													"            if (response.json().total >= 1) {\r",
													"                 throw new Error(\"Well-known resource already exists at \" + url);\r",
													"           } \r",
													"\r",
													"         }\r",
													"    }\r",
													");\r",
													"\r",
													"\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n  \"resourceType\" : \"Questionnaire\",\r\n  \"id\" : \"MedicationsAndFollowUpGuidanceQuestionnaire\",\r\n  \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/MedicationsAndFollowUpGuidanceQuestionnaire\",\r\n  \"identifier\" : [{\r\n    \"use\" : \"official\",\r\n    \"value\" : \"MedicationsAndFollowUpGuidanceQuestionnaire\",\r\n    \"period\" : {\r\n      \"start\" : \"2023-10-16\"\r\n    }\r\n  }],\r\n  \"version\" : \"1.0.0\",\r\n  \"name\" : \"MedicationsAndFollowUpGuidanceQuestionnaire\",\r\n  \"title\" : \"Medications and Follow-up Guidance Questionnaire\",\r\n  \"status\" : \"draft\",\r\n  \"experimental\" : false,\r\n  \"subjectType\" : [\"Patient\"],\r\n  \"date\" : \"2023-11-10\",\r\n  \"publisher\" : \"Te Whatu Ora\",\r\n  \"contact\" : [{\r\n    \"name\" : \"Te Whatu Ora\",\r\n    \"telecom\" : [{\r\n      \"system\" : \"url\",\r\n      \"value\" : \"https://www.tewhatuora.govt.nz/\"\r\n    },\r\n    {\r\n      \"system\" : \"email\",\r\n      \"value\" : \"integration@tewhatuora.govt.nz\"\r\n    }]\r\n  },\r\n  {\r\n    \"name\" : \"HNZ Integration Team\",\r\n    \"telecom\" : [{\r\n      \"system\" : \"email\",\r\n      \"value\" : \"integration@tewhatuora.govt.nz\",\r\n      \"use\" : \"work\"\r\n    }]\r\n  }],\r\n  \"description\" : \"Gathers information in secondary prophylaxis planning which guides subsequent medication appointments and follow-up\",\r\n  \"purpose\" : \"Gathers information in secondary prophylaxis planning which guides subsequent medication appointments and follow-up\",\r\n  \"item\" : [{\r\n    \"linkId\" : \"page1\",\r\n    \"prefix\" : \"page1\",\r\n    \"text\" : \"Please complete this questionnaire to guide practitioners carrying out rheumatic fever secondary prophylaxis.\",\r\n    \"type\" : \"display\"\r\n  },\r\n  {\r\n    \"linkId\" : \"SourceOfOralMedications\",\r\n    \"prefix\" : \"1)\",\r\n    \"text\" : \"Source of oral medications? (choose one)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"GP prescription\"\r\n    },\r\n    {\r\n      \"valueString\" : \"3 monthly visit from a nurse\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Monthly visit from a nurse\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Pick-up from a pharmacy\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Other\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"CaseOnWarfarin\",\r\n    \"prefix\" : \"2)\",\r\n    \"text\" : \"Case on warfarin? (Yes/No/Unknown)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerValueSet\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/ValueSet/nz-questionnaireresponse-qualifiedyesno-code\"\r\n  },\r\n  {\r\n    \"linkId\" : \"WarfarinSupervisionService\",\r\n    \"prefix\" : \"2.1)\",\r\n    \"text\" : \"Warfarin supervision service (choose one)\",\r\n    \"type\" : \"choice\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"CaseOnWarfarin\",\r\n      \"operator\" : \"=\",\r\n      \"answerCoding\" : {\r\n        \"system\" : \"http://snomed.info/sct\",\r\n        \"code\" : \"373066001\",\r\n        \"display\" : \"Yes (qualifier value)\"\r\n      }\r\n    }],\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"GP\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Pharmacy\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Hospital service\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Patient\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Whanau\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"MonitoringResultSource\",\r\n    \"prefix\" : \"3)\",\r\n    \"text\" : \"International normalised ratio (INR) monitoring result source (choose one)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"Patient\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Parent\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Éclair\"\r\n    },\r\n    {\r\n      \"valueString\" : \"GP\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Pharmacy\"\r\n    },\r\n    {\r\n      \"valueString\" : \"INROnline\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Other\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"FollowUpClinicalService\",\r\n    \"prefix\" : \"4)\",\r\n    \"text\" : \"Follow-up clinical service? (choose one)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"Specialist\"\r\n    },\r\n    {\r\n      \"valueString\" : \"GP\"\r\n    },\r\n    {\r\n      \"valueString\" : \"To be determined\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"PrescribingMethod\",\r\n    \"prefix\" : \"5)\",\r\n    \"text\" : \"Method of prescribing (choose one)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : false,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"Community Medication Authority\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Standing Order (local)\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Standing Order (national)\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Individual prescription\"\r\n    }]\r\n  }]\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Questionnaire",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Questionnaire"
											]
										}
									},
									"response": []
								},
								{
									"name": "Get Questionnaire at official Url",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"if(pm.response.json().total === 1){\r",
													"  const id = pm.response.json().entry[0].resource.id;\r",
													"  pm.environment.set(\"T-Qid\", id);\r",
													"}\r",
													"\r",
													"if(pm.response.json().total === 0){\r",
													"    throw new Error (\"Questionnaire resource does not exist with official URL [\" + pm.environment.get(\"OfficialUrl\") + \"].  Please run Create step in this folder to create.\")\r",
													"}\r",
													"\r",
													"if(pm.response.json().total > 1){\r",
													"    throw new Error(\"More than 1 result returned. This indicates duplicate Questionanire resources with official URL [\" + pm.environment.get(\"OfficialUrl\") + \"] present.  Please fix.\")\r",
													"}"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Questionnaire?url={{OfficialUrl}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Questionnaire"
											],
											"query": [
												{
													"key": "url",
													"value": "{{OfficialUrl}}"
												}
											]
										}
									},
									"response": []
								}
							],
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"type": "text/javascript",
										"exec": [
											"pm.environment.set(\"OfficialUrl\",",
											"\t'https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/MedicationsAndFollowUpGuidanceQuestionnaire');"
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								}
							]
						},
						{
							"name": "SecondaryProphylaxisHealthAssessmentQuestionnaire (SPHA)",
							"item": [
								{
									"name": "Create Questionnaire (in DEV/TEST)",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"if (pm.response.code === 201) {\r",
													"    // obtain payload and id as assigned by the server for updating the resource URL in the next step \r",
													"\r",
													"    // get payload as created \r",
													"    const Q = pm.response.json();\r",
													"    pm.environment.set(\"T-Q\", JSON.stringify(Q));\r",
													"\r",
													"    // grab the id\r",
													"    const Qid = pm.response.json().id;\r",
													"    pm.environment.set(\"T-Qid\", pm.response.json().id);      \r",
													"    \r",
													"    // Both the above environment vars are relied on by the next step to update the resource URL\r",
													"}\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"// update CURRENT_DATE element\r",
													"let date = new Date();\r",
													"pm.variables.set(\"CURRENT_DATE\", date.toISOString().slice(0, 10));\r",
													"\r",
													"// Before we create, check if there is already a resource with the well-known identifier\r",
													"// Questionnaire?url={{OfficialUrl}}\r",
													"\r",
													"let url = `${pm.environment.get(\"API_URL\")}/Questionnaire?url=` + `${pm.environment.get(\"OfficialUrl\")}`\r",
													"\r",
													"console.log( \"Checking for well-known resource at \" + url );\r",
													"\r",
													"const getRequest = {\r",
													"  url,\r",
													"  method: 'GET',\r",
													"  header: {\r",
													"    'Authorization': pm.environment.get(\"OAUTH_TOKEN\"),\r",
													"    'x-api-key': pm.environment.get(\"API_KEY\"),\r",
													"    'Request-Context': pm.environment.get(\"REQUEST-CONTEXT\"),\r",
													"  }\r",
													"};\r",
													"\r",
													"const bundle = pm.sendRequest( getRequest, (error, response) => {\r",
													"      if (error) {\r",
													"            console.log(error);\r",
													"         } else {\r",
													"            // console.log(response.json());\r",
													"\r",
													"            if (response.json().total >= 1) {\r",
													"                 throw new Error(\"Well-known resource already exists at \" + url);\r",
													"           } \r",
													"\r",
													"         }\r",
													"    }\r",
													");\r",
													"\r",
													"\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n  \"resourceType\" : \"Questionnaire\",\r\n  \"id\" : \"SecondaryProphylaxisHealthAssessmentQuestionnaire\",\r\n  \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/SecondaryProphylaxisHealthAssessmentQuestionnaire\",\r\n  \"identifier\" : [{\r\n    \"use\" : \"official\",\r\n    \"value\" : \"SecondaryProphylaxisHealthAssessmentQuestionnaire\",\r\n    \"period\" : {\r\n      \"start\" : \"2023-10-16\"\r\n    }\r\n  }],\r\n  \"version\" : \"1.0.0\",\r\n  \"name\" : \"SecondaryProphylaxisHealthAssessmentQuestionnaire\",\r\n  \"title\" : \"Secondary Prophylaxis Health Assessment Questionnaire\",\r\n  \"status\" : \"draft\",\r\n  \"experimental\" : false,\r\n  \"subjectType\" : [\"Patient\"],\r\n  \"date\" : \"2023-11-10\",\r\n  \"publisher\" : \"Te Whatu Ora\",\r\n  \"contact\" : [{\r\n    \"name\" : \"Te Whatu Ora\",\r\n    \"telecom\" : [{\r\n      \"system\" : \"url\",\r\n      \"value\" : \"https://www.tewhatuora.govt.nz/\"\r\n    },\r\n    {\r\n      \"system\" : \"email\",\r\n      \"value\" : \"integration@tewhatuora.govt.nz\"\r\n    }]\r\n  },\r\n  {\r\n    \"name\" : \"HNZ Integration Team\",\r\n    \"telecom\" : [{\r\n      \"system\" : \"email\",\r\n      \"value\" : \"integration@tewhatuora.govt.nz\",\r\n      \"use\" : \"work\"\r\n    }]\r\n  }],\r\n  \"description\" : \"Gathers information about patient health at a secondary prophylaxis medication appointment\",\r\n  \"purpose\" : \"Gathers information about patient health at a secondary prophylaxis medication appointment\",\r\n  \"item\" : [{\r\n    \"linkId\" : \"page1\",\r\n    \"prefix\" : \"page1\",\r\n    \"text\" : \"Please complete this questionnaire at the secondary prophylaxis appointment to assess a rheumatic fever patient's health.\",\r\n    \"type\" : \"display\"\r\n  },\r\n  {\r\n    \"linkId\" : \"ReasonsInjectionOverdue\",\r\n    \"prefix\" : \"2)\",\r\n    \"text\" : \"Reason(s) injection was give late? (multiple choice)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : true,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"Previously Care On-Hold\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Unable to Contact Patient\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Patient Not Available on the Day\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Patient Declined Treatment\"\r\n    },\r\n    {\r\n      \"valueString\" : \"INR Too High\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Patient Lost to Follow-Up\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Service Delayed To Follow-Up\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Service Unavailable on the Day\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Service Error\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Other\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"OverdueInjectionOtherDetail\",\r\n    \"prefix\" : \"3)\",\r\n    \"text\" : \"Other details for late injection (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"OtherPainManagementToolsUsed\",\r\n    \"prefix\" : \"11)\",\r\n    \"text\" : \"Pain management tools used? (multiple choice)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : true,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"Ice pack\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Buzzy bee\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Numbing cream (Emla)\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Numbing spray\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Distraction\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Very slow injection\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Other\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"PainManagementOtherDetails\",\r\n    \"prefix\" : \"11.1)\",\r\n    \"text\" : \"Details of other pain management (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"OtherPainManagementToolsUsed\",\r\n      \"operator\" : \"=\",\r\n      \"answerString\" : \"Other\"\r\n    }],\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"PostInjectionConcern\",\r\n    \"prefix\" : \"12)\",\r\n    \"text\" : \"Post injection concern or possible reaction identified?\",\r\n    \"type\" : \"boolean\",\r\n    \"required\" : true,\r\n    \"initial\" : [{\r\n      \"valueBoolean\" : false\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"PostInjectionConcernDetails\",\r\n    \"prefix\" : \"12.1)\",\r\n    \"text\" : \"If Yes, Record Details, Symptoms, Actions Taken and Follow-Up Plan (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"PostInjectionConcern\",\r\n      \"operator\" : \"=\",\r\n      \"answerBoolean\" : true\r\n    }],\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"AnyOtherConcerns\",\r\n    \"prefix\" : \"13)\",\r\n    \"text\" : \"Were There Any Other Concerns or Issues Identified During the Visit?\",\r\n    \"type\" : \"boolean\",\r\n    \"required\" : true,\r\n    \"initial\" : [{\r\n      \"valueBoolean\" : false\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"OtherConcernsDetail\",\r\n    \"prefix\" : \"13.1)\",\r\n    \"text\" : \"If yes, describe details, actions taken, and follow-up planned (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"AnyOtherConcerns\",\r\n      \"operator\" : \"=\",\r\n      \"answerBoolean\" : true\r\n    }],\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"HealthEducationTopicsDiscussed\",\r\n    \"prefix\" : \"14)\",\r\n    \"text\" : \"Health education topics discussed? (multiple choice)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : true,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"Secondary prophylaxis\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Sore Throat Management\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Skin Infection Management\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Dental Health\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Endocarditis Prophylaxis\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Nutrition\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Physical Activity\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Healthy Home Environments\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Sexual Health\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Other\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"HealthEducationOtherDetail\",\r\n    \"prefix\" : \"14.1)\",\r\n    \"text\" : \"Enter details of other health education topic discussed (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"HealthEducationTopicsDiscussed\",\r\n      \"operator\" : \"=\",\r\n      \"answerString\" : \"Other\"\r\n    }],\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"RecentOrUpcomingAppointments\",\r\n    \"prefix\" : \"15)\",\r\n    \"text\" : \"Any recent or upcoming follow-up appointments?\",\r\n    \"type\" : \"boolean\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"RecentOrUpcomingAppointmentsDetails\",\r\n    \"prefix\" : \"15.1)\",\r\n    \"text\" : \"Enter details and dates of any recent or upcoming follow-up appointments (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"RecentOrUpcomingAppointments\",\r\n      \"operator\" : \"=\",\r\n      \"answerBoolean\" : true\r\n    }],\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"PlanForNextMedicationAppointment\",\r\n    \"prefix\" : \"16)\",\r\n    \"text\" : \"Comments for the next appointment (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  }]\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Questionnaire",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Questionnaire"
											]
										}
									},
									"response": []
								},
								{
									"name": "Get Questionnaire at official Url",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"if(pm.response.json().total === 1){\r",
													"  const id = pm.response.json().entry[0].resource.id;\r",
													"  pm.environment.set(\"T-Qid\", id);\r",
													"}\r",
													"\r",
													"if(pm.response.json().total === 0){\r",
													"    throw new Error(\"Questionnaire resource does not exist with official URL [\" + pm.environment.get(\"OfficialUrl\") + \"].  Please run Create step in this folder to create.\")\r",
													"}\r",
													"\r",
													"if(pm.response.json().total > 1){\r",
													"    throw new Error(\"More than 1 result returned. This indicates duplicate Questionanire resources with official URL [\" + pm.environment.get(\"OfficialUrl\") + \"] present.  Please fix.\")\r",
													"}"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Questionnaire?url={{OfficialUrl}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Questionnaire"
											],
											"query": [
												{
													"key": "url",
													"value": "{{OfficialUrl}}"
												}
											]
										}
									},
									"response": []
								}
							],
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"type": "text/javascript",
										"exec": [
											"pm.environment.set(\"OfficialUrl\",",
											"\t'https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/SecondaryProphylaxisHealthAssessmentQuestionnaire');"
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								}
							]
						},
						{
							"name": "Oral Secondary Prophylaxis Health Assessment Questionnaire (OSPHA)",
							"item": [
								{
									"name": "Create Questionnaire (in DEV/TEST)",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"if (pm.response.code === 201) {\r",
													"    // obtain payload and id as assigned by the server for updating the resource URL in the next step \r",
													"\r",
													"    // get payload as created \r",
													"    const Q = pm.response.json();\r",
													"    pm.environment.set(\"T-Q\", JSON.stringify(Q));\r",
													"\r",
													"    // grab the id\r",
													"    const Qid = pm.response.json().id;\r",
													"    pm.environment.set(\"T-Qid\", pm.response.json().id);      \r",
													"    \r",
													"    // Both the above environment vars are relied on by the next step to update the resource URL\r",
													"}\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"// update CURRENT_DATE element\r",
													"let date = new Date();\r",
													"pm.variables.set(\"CURRENT_DATE\", date.toISOString().slice(0, 10));\r",
													"\r",
													"// Before we create, check if there is already a resource with the well-known identifier\r",
													"// Questionnaire?url={{OfficialUrl}}\r",
													"\r",
													"let url = `${pm.environment.get(\"API_URL\")}/Questionnaire?url=` + `${pm.environment.get(\"OfficialUrl\")}`\r",
													"\r",
													"console.log( \"Checking for well-known resource at \" + url );\r",
													"\r",
													"const getRequest = {\r",
													"  url,\r",
													"  method: 'GET',\r",
													"  header: {\r",
													"    'Authorization': pm.environment.get(\"OAUTH_TOKEN\"),\r",
													"    'x-api-key': pm.environment.get(\"API_KEY\"),\r",
													"    'Request-Context': pm.environment.get(\"REQUEST-CONTEXT\"),\r",
													"  }\r",
													"};\r",
													"\r",
													"const bundle = pm.sendRequest( getRequest, (error, response) => {\r",
													"      if (error) {\r",
													"            console.log(error);\r",
													"         } else {\r",
													"            // console.log(response.json());\r",
													"\r",
													"            if (response.json().total >= 1) {\r",
													"                 throw new Error(\"Well-known resource already exists at \" + url);\r",
													"           } \r",
													"\r",
													"         }\r",
													"    }\r",
													");\r",
													"\r",
													"\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n  \"resourceType\" : \"Questionnaire\",\r\n  \"id\" : \"OralSecondaryProphylaxisHealthAssessmentQuestionnaire\",\r\n  \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/OralSecondaryProphylaxisHealthAssessmentQuestionnaire\",\r\n  \"identifier\" : [{\r\n    \"use\" : \"official\",\r\n    \"value\" : \"OralSecondaryProphylaxisHealthAssessmentQuestionnaire\",\r\n    \"period\" : {\r\n      \"start\" : \"2024-06-17\"\r\n    }\r\n  }],\r\n  \"version\" : \"1.0.0\",\r\n  \"name\" : \"OralSecondaryProphylaxisHealthAssessmentQuestionnaire\",\r\n  \"title\" : \"Oral Secondary Prophylaxis Health Assessment Questionnaire\",\r\n  \"status\" : \"draft\",\r\n  \"experimental\" : false,\r\n  \"subjectType\" : [\"Patient\"],\r\n  \"date\" : \"2024-06-17\",\r\n  \"publisher\" : \"Te Whatu Ora\",\r\n  \"contact\" : [{\r\n    \"name\" : \"Te Whatu Ora\",\r\n    \"telecom\" : [{\r\n      \"system\" : \"url\",\r\n      \"value\" : \"https://www.tewhatuora.govt.nz/\"\r\n    },\r\n    {\r\n      \"system\" : \"email\",\r\n      \"value\" : \"integration@tewhatuora.govt.nz\"\r\n    }]\r\n  },\r\n  {\r\n    \"name\" : \"HNZ Integration Team\",\r\n    \"telecom\" : [{\r\n      \"system\" : \"email\",\r\n      \"value\" : \"integration@tewhatuora.govt.nz\",\r\n      \"use\" : \"work\"\r\n    }]\r\n  }],\r\n  \"description\" : \"Gathers information about patient health at an oral secondary prophylaxis medication appointment\",\r\n  \"purpose\" : \"Gathers information about patient health at an appointemnt for oral secondary prophylaxis medication\",\r\n  \"item\" : [{\r\n    \"linkId\" : \"page1\",\r\n    \"prefix\" : \"page1\",\r\n    \"text\" : \"Please complete this questionnaire at the oral secondary prophylaxis appointment to assess a rheumatic fever patient's health.\",\r\n    \"type\" : \"display\"\r\n  },\r\n  {\r\n    \"linkId\" : \"MedicationIssues\",\r\n    \"prefix\" : \"1\",\r\n    \"text\" : \"Has the patient had any issues taking their medications?\",\r\n    \"type\" : \"boolean\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"DelaysObtainingMedication\",\r\n    \"prefix\" : \"2)\",\r\n    \"text\" : \"Were there delays in obtaining medications that interrupted the patient’s treatment?\",\r\n    \"type\" : \"boolean\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"DelaysObtainingMedicationDetail\",\r\n    \"prefix\" : \"2.1)\",\r\n    \"text\" : \"Enter details of delays in obtaining medication that interrupted patient's treatment (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"DelaysObtainingMedication\",\r\n      \"operator\" : \"=\",\r\n      \"answerBoolean\" : true\r\n    }],\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"SufficientMedication\",\r\n    \"prefix\" : \"3)\",\r\n    \"text\" : \"Does the patient have enough medication to last until their next check-in?\",\r\n    \"type\" : \"boolean\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"PlanForObtainingMedications\",\r\n    \"prefix\" : \"4)\",\r\n    \"text\" : \"Plan for obtaining medications to last until next check-in (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"AnyOtherConcerns\",\r\n    \"prefix\" : \"5)\",\r\n    \"text\" : \"Were There Any Other Concerns or Issues Identified During the Visit?\",\r\n    \"type\" : \"boolean\",\r\n    \"required\" : true,\r\n    \"initial\" : [{\r\n      \"valueBoolean\" : false\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"OtherConcernsDetail\",\r\n    \"prefix\" : \"5.1)\",\r\n    \"text\" : \"If yes, describe details, actions taken, and follow-up planned (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"AnyOtherConcerns\",\r\n      \"operator\" : \"=\",\r\n      \"answerBoolean\" : true\r\n    }],\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"HealthEducationTopicsDiscussed\",\r\n    \"prefix\" : \"6)\",\r\n    \"text\" : \"Health education topics discussed? (multiple choice)\",\r\n    \"type\" : \"choice\",\r\n    \"required\" : true,\r\n    \"repeats\" : true,\r\n    \"answerOption\" : [{\r\n      \"valueString\" : \"Secondary prophylaxis\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Sore Throat Management\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Skin Infection Management\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Dental Health\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Endocarditis Prophylaxis\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Nutrition\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Physical Activity\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Healthy Home Environments\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Sexual Health\"\r\n    },\r\n    {\r\n      \"valueString\" : \"Other\"\r\n    }]\r\n  },\r\n  {\r\n    \"linkId\" : \"HealthEducationOtherDetail\",\r\n    \"prefix\" : \"6.1)\",\r\n    \"text\" : \"Enter details of other health education topic discussed (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"HealthEducationTopicsDiscussed\",\r\n      \"operator\" : \"=\",\r\n      \"answerString\" : \"Other\"\r\n    }],\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"RecentOrUpcomingAppointments\",\r\n    \"prefix\" : \"7)\",\r\n    \"text\" : \"Any recent or upcoming follow-up appointments?\",\r\n    \"type\" : \"boolean\",\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"RecentOrUpcomingAppointmentsDetails\",\r\n    \"prefix\" : \"7.1)\",\r\n    \"text\" : \"Enter details and dates of any recent or upcoming follow-up appointments (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"enableWhen\" : [{\r\n      \"question\" : \"RecentOrUpcomingAppointments\",\r\n      \"operator\" : \"=\",\r\n      \"answerBoolean\" : true\r\n    }],\r\n    \"required\" : true\r\n  },\r\n  {\r\n    \"linkId\" : \"PlanForNextMedicationAppointment\",\r\n    \"prefix\" : \"8)\",\r\n    \"text\" : \"Comments for the next appointment (enter text)\",\r\n    \"type\" : \"text\",\r\n    \"required\" : true\r\n  }]\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Questionnaire",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Questionnaire"
											]
										}
									},
									"response": []
								},
								{
									"name": "Get Questionnaire at official Url",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"if(pm.response.json().total === 1){\r",
													"  const id = pm.response.json().entry[0].resource.id;\r",
													"  pm.environment.set(\"T-Qid\", id);\r",
													"}\r",
													"\r",
													"if(pm.response.json().total === 0){\r",
													"    throw new Error(\"Questionnaire resource does not exist with official URL [\" + pm.environment.get(\"OfficialUrl\") + \"].  Please run Create step in this folder to create.\")\r",
													"}\r",
													"\r",
													"if(pm.response.json().total > 1){\r",
													"    throw new Error(\"More than 1 result returned. This indicates duplicate Questionanire resources with official URL [\" + pm.environment.get(\"OfficialUrl\") + \"] present.  Please fix.\")\r",
													"}"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Questionnaire?url={{OfficialUrl}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Questionnaire"
											],
											"query": [
												{
													"key": "url",
													"value": "{{OfficialUrl}}"
												}
											]
										}
									},
									"response": []
								}
							],
							"event": [
								{
									"listen": "prerequest",
									"script": {
										"type": "text/javascript",
										"exec": [
											"pm.environment.set(\"OfficialUrl\",",
											"\t'https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/OralSecondaryProphylaxisHealthAssessmentQuestionnaire');"
										]
									}
								},
								{
									"listen": "test",
									"script": {
										"type": "text/javascript",
										"exec": [
											""
										]
									}
								}
							]
						}
					]
				}
			],
			"description": "Definitional resources such as FHIR Questionnaires have to be seeded in DEV and TEST environments by the developer, because these environments are always sandboxes with resource visibility restricted to each FHIRWorks user (client id).\n\nIn UAT and PROD, the following definitional resource types are seeded automatically as part of environment deployment:\n\n- `Questionnaire`\n    \n- `PlanDefinition`\n    \n- `ActivityDefinition`"
		},
		{
			"name": "rheumatic fever FHIR sequence",
			"item": [
				{
					"name": "Patient Registration Phase",
					"item": [
						{
							"name": "Setup Data Consent",
							"item": [
								{
									"name": "Create Initial Active Consent",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-RFConsentId\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"resourceType\" : \"Consent\",\n  \"meta\" : {\n    \"profile\" : [\"http://hl7.org/fhir/StructureDefinition/Consent\"]\n  },\n  \"status\" : \"active\",\n  \"scope\" : {\n    \"coding\" : [{\n      \"system\" : \"http://terminology.hl7.org/CodeSystem/consentscope\",\n      \"code\" : \"patient-privacy\",\n      \"display\" : \"Privacy Consent\"\n    }]\n  },\n  \"category\" : [{\n    \"coding\" : [{\n      \"system\" : \"http://terminology.hl7.org/CodeSystem/consentcategorycodes\",\n      \"code\" : \"npp\",\n      \"display\" : \"Notice of Privacy Practices\"\n    }]\n  }],\n  \"patient\" : {\n    \"type\" : \"Patient\",\n    \"identifier\" : {\n      \"use\" : \"official\",\n      \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\n      \"value\" : \"ZKC7284\"\n    },\n    \"display\" : \"Sage Westbrook\"\n  },\n  \"organization\" : [{\n    \"type\" : \"Organization\",\n    \"identifier\" : {\n      \"use\" : \"official\",\n      \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n      \"value\" : \"G0M086-B\"\n    },\n    \"display\" : \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n  }],\n  \"policy\" : [{\n    \"authority\" : \"https://www.privacy.org.nz\",\n    \"uri\" : \"https://www.privacy.org.nz/privacy-act-2020/\"\n  },\n  {\n    \"authority\" : \"https://www.privacy.org.nz\",\n    \"uri\" : \"https://www.privacy.org.nz/privacy-act-2020/codes-of-practice/hipc2020/\"\n  }],\n  \"provision\" : {\n    \"type\" : \"permit\",\n    \"period\" : {\n      \"start\" : \"2023-06-12T02:30:35Z\",\n      \"end\" : \"2026-06-11T02:30:35Z\"\n    }\n  }\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Consent",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Consent"
											]
										}
									},
									"response": []
								}
							]
						},
						{
							"name": "Register Patient",
							"item": [
								{
									"name": "Create RF Patient with Whanau",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-RFPatientId\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"let date = new Date();\r",
													"pm.variables.set(\"CURRENT_DATE\", date.toISOString().slice(0, 10));\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n  \"resourceType\" : \"Patient\",\r\n  \"meta\" : {\r\n    \"versionId\" : \"2\",\r\n    \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\r\n    \"profile\" : [\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-patient|1.0.0\"],\r\n    \"tag\" : [{\r\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\r\n      \"code\" : \"rf-nz\",\r\n      \"display\" : \"rheumatic fever\"\r\n    }]\r\n  },\r\n  \"extension\" : [{\r\n    \"url\" : \"http://hl7.org/fhir/StructureDefinition/patient-interpreterRequired\",\r\n    \"valueBoolean\" : false\r\n  },\r\n  {\r\n    \"url\" : \"http://hl7.org.nz/fhir/StructureDefinition/nz-ethnicity\",\r\n    \"valueCodeableConcept\" : {\r\n      \"coding\" : [{\r\n        \"system\" : \"https://standards.digital.health.nz/ns/ethnic-group-level-4-code\",\r\n        \"code\" : \"11111\",\r\n        \"display\" : \"New Zealand European\"\r\n      }]\r\n    }\r\n  },\r\n  {\r\n    \"extension\" : [{\r\n      \"url\" : \"status\",\r\n      \"valueCodeableConcept\" : {\r\n        \"coding\" : [{\r\n          \"system\" : \"https://standards.digital.health.nz/ns/nz-citizenship-status-code\",\r\n          \"code\" : \"yes\",\r\n          \"display\" : \"Yes\"\r\n        }]\r\n      }\r\n    },\r\n    {\r\n      \"url\" : \"source\",\r\n      \"valueCodeableConcept\" : {\r\n        \"coding\" : [{\r\n          \"system\" : \"https://standards.digital.health.nz/ns/information-source-code\",\r\n          \"code\" : \"BREG\",\r\n          \"display\" : \"Birth Register\"\r\n        }]\r\n      }\r\n    }],\r\n    \"url\" : \"http://hl7.org.nz/fhir/StructureDefinition/nz-citizenship\"\r\n  }],\r\n  \"identifier\" : [{\r\n    \"use\" : \"official\",\r\n    \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\r\n    \"value\" : \"ZKC7284\"\r\n  }],\r\n  \"name\" : [{\r\n    \"use\" : \"usual\",\r\n    \"family\" : \"Westbrook\",\r\n    \"given\" : [\"Sage\"]\r\n  }],\r\n  \"telecom\" : [{\r\n    \"system\" : \"phone\",\r\n    \"value\" : \"+64 22 134 1304\",\r\n    \"rank\" : 1\r\n  },\r\n  {\r\n    \"system\" : \"phone\",\r\n    \"value\" : \"+64 22 134 1304\",\r\n    \"rank\" : 1\r\n  },\r\n  {\r\n    \"system\" : \"phone\",\r\n    \"value\" : \"+64 9 379 1357\",\r\n    \"rank\" : 2\r\n  },\r\n  {\r\n    \"system\" : \"email\",\r\n    \"value\" : \"sugarhit@gmail.com\",\r\n    \"rank\" : 3\r\n  }],\r\n  \"gender\" : \"female\",\r\n  \"birthDate\" : \"2008-11-24\",\r\n  \"deceasedBoolean\" : false,\r\n  \"address\" : [{\r\n    \"use\" : \"home\",\r\n    \"text\" : \"19 Bayside Lane, Parua Bay, Whangārei 0174, New Zealand\",\r\n    \"line\" : [\"19 Bayside Lane\",\r\n    \"Parua Bay\"],\r\n    \"city\" : \"Whangārei\",\r\n    \"postalCode\" : \"0174\",\r\n    \"country\" : \"NZL\",\r\n    \"period\" : {\r\n      \"start\" : \"2023-08-01\"\r\n    }\r\n  }],\r\n  \"contact\" : [{\r\n    \"extension\" : [{\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-primary\",\r\n      \"valueBoolean\" : true\r\n    },\r\n    {\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-role\",\r\n      \"valueCoding\" : {\r\n        \"system\" : \"http://snomed.info/sct\",\r\n        \"code\" : \"58626002\",\r\n        \"display\" : \"Legal guardian\"\r\n      }\r\n    },\r\n    {\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-relationship\",\r\n      \"valueString\" : \"mother\"\r\n    }],\r\n    \"name\" : {\r\n      \"family\" : \"Hackett\",\r\n      \"given\" : [\"Beryl\"]\r\n    },\r\n    \"telecom\" : [{\r\n      \"system\" : \"phone\",\r\n      \"value\" : \"+64 21 111 111\",\r\n      \"rank\" : 1\r\n    },\r\n    {\r\n      \"system\" : \"email\",\r\n      \"value\" : \"person1@gmail.com\",\r\n      \"rank\" : 2\r\n    }],\r\n    \"period\" : {\r\n      \"start\" : \"2023-06-01\",\r\n      \"end\" : \"2026-01-01\"\r\n    }\r\n  },\r\n  {\r\n    \"extension\" : [{\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-primary\",\r\n      \"valueBoolean\" : false\r\n    },\r\n    {\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-role\",\r\n      \"valueCoding\" : {\r\n        \"system\" : \"http://terminology.hl7.org/CodeSystem/v2-0131\",\r\n        \"code\" : \"O\",\r\n        \"display\" : \"other\"\r\n      }\r\n    },\r\n    {\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-relationship\",\r\n      \"valueString\" : \"friend\"\r\n    }],\r\n    \"name\" : {\r\n      \"family\" : \"Punga\",\r\n      \"given\" : [\"Pania\"]\r\n    },\r\n    \"telecom\" : [{\r\n      \"system\" : \"phone\",\r\n      \"value\" : \"+64 21 111 555\",\r\n      \"rank\" : 1\r\n    },\r\n    {\r\n      \"system\" : \"email\",\r\n      \"value\" : \"person5@gmail.com\",\r\n      \"rank\" : 2\r\n    }],\r\n    \"period\" : {\r\n      \"start\" : \"2023-06-01\",\r\n      \"end\" : \"2026-01-01\"\r\n    }\r\n  },\r\n  {\r\n    \"extension\" : [{\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-primary\",\r\n      \"valueBoolean\" : false\r\n    },\r\n    {\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-role\",\r\n      \"valueCoding\" : {\r\n        \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\r\n        \"code\" : \"320731000210100\",\r\n        \"display\" : \"Support person\"\r\n      }\r\n    },\r\n    {\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-relationship\",\r\n      \"valueString\" : \"aunt\"\r\n    }],\r\n    \"name\" : {\r\n      \"family\" : \"Donut\",\r\n      \"given\" : [\"Delina\"]\r\n    },\r\n    \"telecom\" : [{\r\n      \"system\" : \"phone\",\r\n      \"value\" : \"+64 21 111 333\",\r\n      \"rank\" : 1\r\n    },\r\n    {\r\n      \"system\" : \"email\",\r\n      \"value\" : \"person3@gmail.com\",\r\n      \"rank\" : 2\r\n    }],\r\n    \"period\" : {\r\n      \"start\" : \"2023-06-01\",\r\n      \"end\" : \"2026-01-01\"\r\n    }\r\n  },\r\n  {\r\n    \"extension\" : [{\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-primary\",\r\n      \"valueBoolean\" : false\r\n    },\r\n    {\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-role\",\r\n      \"valueCoding\" : {\r\n        \"system\" : \"http://terminology.hl7.org/CodeSystem/v3-RoleCode\",\r\n        \"code\" : \"FTH\",\r\n        \"display\" : \"Father\"\r\n      }\r\n    },\r\n    {\r\n      \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-patient-whanaumember-relationship\",\r\n      \"valueString\" : \"father\"\r\n    }],\r\n    \"name\" : {\r\n      \"family\" : \"Westbrook\",\r\n      \"given\" : [\"Cyril\"]\r\n    },\r\n    \"telecom\" : [{\r\n      \"system\" : \"phone\",\r\n      \"value\" : \"+64 21 111 444\",\r\n      \"rank\" : 1\r\n    },\r\n    {\r\n      \"system\" : \"email\",\r\n      \"value\" : \"person4@gmail.com\",\r\n      \"rank\" : 2\r\n    }],\r\n    \"period\" : {\r\n      \"start\" : \"2021-01-01\",\r\n      \"end\" : \"2023-01-01\"\r\n    }\r\n  }],\r\n  \"communication\" : [{\r\n    \"language\" : {\r\n      \"coding\" : [{\r\n        \"system\" : \"urn:ietf:bcp:47\",\r\n        \"code\" : \"en\",\r\n        \"display\" : \"English\"\r\n      }]\r\n    }\r\n  }],\r\n  \"link\" : [{\r\n    \"other\" : {\r\n      \"type\" : \"Patient\",\r\n      \"identifier\" : {\r\n        \"use\" : \"official\",\r\n        \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\r\n        \"value\" : \"ZKC7284\"\r\n      },\r\n      \"display\" : \"Sage Westbrook\"\r\n    },\r\n    \"type\" : \"seealso\"\r\n  }]\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Patient",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Patient"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create RFCondition as initially registered",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-Condition\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"let date = new Date();\r",
													"pm.variables.set(\"CURRENT_DATE\", date.toISOString().slice(0, 10));\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n  \"resourceType\" : \"Condition\",\r\n  \"meta\" : {\r\n    \"versionId\" : \"2\",\r\n    \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\r\n    \"profile\" : [\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-condition\"],\r\n    \"tag\" : [{\r\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\r\n      \"code\" : \"rf-nz\",\r\n      \"display\" : \"rheumatic fever\"\r\n    }]\r\n  },\r\n  \"extension\" : [{\r\n    \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-condition-rhdseverity\",\r\n    \"valueCoding\" : {\r\n      \"system\" : \"http://snomed.info/sct\",\r\n      \"code\" : \"24484000\",\r\n      \"display\" : \"Severe (severity modifier) (qualifier value)\"\r\n    }\r\n  },\r\n  {\r\n    \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-condition-diagnosticcertainty\",\r\n    \"valueCoding\" : {\r\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\r\n      \"code\" : \"probable\",\r\n      \"display\" : \"probable\"\r\n    }\r\n  },\r\n  {\r\n    \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-condition-assessmentdate\",\r\n    \"valueDateTime\" : \"2023-03-12T02:00:00Z\"\r\n  },\r\n  {\r\n    \"url\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-condition-symptomaticAtDiagnosis\",\r\n    \"valueCoding\" : {\r\n      \"system\" : \"http://snomed.info/sct\",\r\n      \"code\" : \"264931009\",\r\n      \"display\" : \"Symptomatic (qualifier value)\"\r\n    }\r\n  }],\r\n  \"identifier\" : [{\r\n    \"use\" : \"usual\",\r\n    \"type\" : {\r\n      \"coding\" : [{\r\n        \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\r\n        \"code\" : \"rfccs-condition-id\"\r\n      }]\r\n    },\r\n    \"system\" : \"https://standards.digital.health.nz/ns/rf-ccs-id\",\r\n    \"value\" : \"CON-0206\"\r\n  },\r\n  {\r\n    \"use\" : \"usual\",\r\n    \"type\" : {\r\n      \"coding\" : [{\r\n        \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\r\n        \"code\" : \"episurv-number\"\r\n      }]\r\n    },\r\n    \"system\" : \"https://episurv.esr.cri.nz/\",\r\n    \"value\" : \"21-383414-AK\"\r\n  }],\r\n  \"clinicalStatus\" : {\r\n    \"coding\" : [{\r\n      \"system\" : \"http://terminology.hl7.org/CodeSystem/condition-clinical\",\r\n      \"code\" : \"active\",\r\n      \"display\" : \"Active\"\r\n    }],\r\n    \"text\" : \"Active\"\r\n  },\r\n  \"verificationStatus\" : {\r\n    \"coding\" : [{\r\n      \"system\" : \"http://terminology.hl7.org/CodeSystem/condition-ver-status\",\r\n      \"code\" : \"confirmed\",\r\n      \"display\" : \"Confirmed\"\r\n    }],\r\n    \"text\" : \"Confirmed\"\r\n  },\r\n  \"category\" : [{\r\n    \"coding\" : [{\r\n      \"system\" : \"http://snomed.info/sct\",\r\n      \"code\" : \"58718002\",\r\n      \"display\" : \"Rheumatic fever (disorder)\"\r\n    }]\r\n  },\r\n  {\r\n    \"coding\" : [{\r\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\r\n      \"code\" : \"rf-nz\",\r\n      \"display\" : \"rheumatic fever\"\r\n    }]\r\n  }],\r\n  \"severity\" : {\r\n    \"coding\" : [{\r\n      \"system\" : \"http://snomed.info/sct\",\r\n      \"code\" : \"24484000\",\r\n      \"display\" : \"Severe\"\r\n    }]\r\n  },\r\n  \"code\" : {\r\n    \"coding\" : [{\r\n      \"system\" : \"http://snomed.info/sct\",\r\n      \"code\" : \"195528001\",\r\n      \"display\" : \"Acute rheumatic fever (disorder)\"\r\n    }]\r\n  },\r\n  \"subject\" : {\r\n    \"type\" : \"Patient\",\r\n    \"identifier\" : {\r\n      \"use\" : \"official\",\r\n      \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\r\n      \"value\" : \"ZKC7284\"\r\n    },\r\n    \"display\" : \"Sage Westbrook\"\r\n  },\r\n  \"onsetDateTime\" : \"2023-02-05T02:00:00Z\",\r\n  \"recordedDate\" : \"2023-03-12T02:00:00Z\",\r\n  \"recorder\" : {\r\n    \"type\" : \"Practitioner\",\r\n    \"identifier\" : {\r\n      \"use\" : \"official\",\r\n      \"system\" : \"https://standards.digital.health.nz/ns/hpi-practitioner-id\",\r\n      \"value\" : \"99ZZFX\"\r\n    },\r\n    \"display\" : \"Dottie McStuffins\"\r\n  }\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Condition",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Condition"
											]
										}
									},
									"response": []
								},
								{
									"name": "Initialise RF CarePlan to get id for QR linking",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-RFCarePlanId\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"resourceType\": \"CarePlan\",\n\t\"meta\": {\n\t\t\"versionId\": \"2\",\n\t\t\"lastUpdated\": \"2024-08-07T08:31:00Z\",\n\t\t\"profile\": [\n\t\t\t\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-careplan|1.0.0\"\n\t\t],\n\t\t\"tag\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t}\n\t\t]\n\t},\n\t\"extension\": [\n\t\t{\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-careplan-lifelongSecondaryProphylaxis\",\n\t\t\t\"valueBoolean\": false\n\t\t},\n\t\t{\n\t\t\t\"extension\": [\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"toStatus\",\n\t\t\t\t\t\"valueCoding\": {\n\t\t\t\t\t\t\"system\": \"http://hl7.org/fhir/request-status\",\n\t\t\t\t\t\t\"code\": \"draft\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"changeDate\",\n\t\t\t\t\t\"valueDate\": \"2023-06-19\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"changeReason\",\n\t\t\t\t\t\"valueString\": \"new patient\"\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-careplan-statusHistory\"\n\t\t}\n\t],\n\t\"identifier\": [\n\t\t{\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n\t\t\t\"value\": \"ZKC7284\"\n\t\t},\n\t\t{\n\t\t\t\"use\": \"usual\",\n\t\t\t\"type\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\t\"code\": \"rfccs-careplan-id\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n\t\t\t\"value\": \"00073693\"\n\t\t}\n\t],\n\t\"status\": \"draft\",\n\t\"intent\": \"plan\",\n\t\"category\": [\n\t\t{\n\t\t\t\"coding\": [\n\t\t\t\t{\n\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"title\": \"Care plan in initial state after Sage Westbrook registered\",\n\t\"subject\": {\n\t\t\"reference\": \"Patient/SageWestbrook\",\n\t\t\"type\": \"Patient\"\n\t},\n\t\"period\": {\n\t\t\"start\": \"2023-08-01T00:00:00Z\",\n\t\t\"end\": \"2033-07-31T00:00:00Z\"\n\t},\n\t\"created\": \"2023-06-12T00:00:00Z\",\n\t\"author\": {\n\t\t\"type\": \"Organization\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n\t\t\t\"value\": \"G0M086-B\"\n\t\t},\n\t\t\"display\": \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n\t},\n\t\"careTeam\": [\n\t\t{\n\t\t\t\"reference\": \"CareTeam/{{T-RFProphylaxisCareTeamId}}\"\n\t\t}\n\t],\n\t\"addresses\": [\n\t\t{\n\t\t\t\"reference\": \"Condition/{{T-Condition}}\",\n\t\t\t\"type\": \"Condition\"\n\t\t}\n\t],\n\t\"supportingInfo\": [\n\t\t{\n\t\t\t\"reference\": \"QuestionnaireResponse/{{T-PMAQRId}}\"\n\t\t},\n\t\t{\n\t\t\t\"reference\": \"QuestionnaireResponse/{{T-MFUGQRId}}\"\n\t\t},\n\t\t{\n\t\t\t\"reference\": \"QuestionnaireResponse/{{T-PWGOALQRId}}\"\n\t\t}\n\t]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/CarePlan",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"CarePlan"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create Secondary Prophylaxis Care Team",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-RFProphylaxisCareTeamId\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"let date = new Date();\r",
													"pm.variables.set(\"CURRENT_DATE\", date.toISOString().slice(0, 10));\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n  \"resourceType\" : \"CareTeam\",\r\n  \"meta\" : {\r\n    \"versionId\" : \"2\",\r\n    \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\r\n    \"profile\" : [\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-careteam|1.0.0\"],\r\n    \"tag\" : [{\r\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\r\n      \"code\" : \"rf-nz\",\r\n      \"display\" : \"rheumatic fever\"\r\n    }]\r\n  },\r\n  \"identifier\" : [{\r\n    \"use\" : \"usual\",\r\n    \"type\" : {\r\n      \"coding\" : [{\r\n        \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\r\n        \"code\" : \"rfccs-careteam-id\"\r\n      }]\r\n    },\r\n    \"system\" : \"https://standards.digital.health.nz/ns/rf-ccs-id\",\r\n    \"value\" : \"CTM-0016606\"\r\n  }],\r\n  \"status\" : \"active\",\r\n  \"category\" : [{\r\n    \"coding\" : [{\r\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\r\n      \"code\" : \"rf-nz\",\r\n      \"display\" : \"rheumatic fever\"\r\n    }]\r\n  }],\r\n  \"name\" : \"Sage Westbrook's secondary prophylaxis team\",\r\n  \"participant\" : [{\r\n    \"member\" : {\r\n      \"type\" : \"Organization\",\r\n      \"identifier\" : {\r\n        \"use\" : \"official\",\r\n        \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\r\n        \"value\" : \"G0M086-B\"\r\n      },\r\n      \"display\" : \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\r\n    },\r\n    \"period\" : {\r\n      \"start\" : \"2024-05-14\"\r\n    }\r\n  },\r\n  {\r\n    \"role\" : [{\r\n      \"coding\" : [{\r\n        \"system\" : \"http://snomed.info/sct\",\r\n        \"code\" : \"224535009\",\r\n        \"display\" : \"Registered nurse\"\r\n      }]\r\n    }],\r\n    \"member\" : {\r\n      \"type\" : \"Practitioner\",\r\n      \"identifier\" : {\r\n        \"use\" : \"official\",\r\n        \"system\" : \"https://standards.digital.health.nz/ns/hpi-practitioner-id\",\r\n        \"value\" : \"98ZZQJ\"\r\n      },\r\n      \"display\" : \"Isabel Injecta\"\r\n    },\r\n    \"onBehalfOf\" : {\r\n      \"type\" : \"Organization\",\r\n      \"identifier\" : {\r\n        \"use\" : \"official\",\r\n        \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\r\n        \"value\" : \"G0M086-B\"\r\n      },\r\n      \"display\" : \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\r\n    },\r\n    \"period\" : {\r\n      \"start\" : \"2024-05-14\"\r\n    }\r\n  },\r\n  {\r\n    \"member\" : {\r\n      \"type\" : \"Organization\",\r\n      \"identifier\" : {\r\n        \"use\" : \"official\",\r\n        \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\r\n        \"value\" : \"G0M744-C\"\r\n      },\r\n      \"display\" : \"Taranaki Rheumatic Fever Secondary Prevention Service\"\r\n    },\r\n    \"period\" : {\r\n      \"start\" : \"2024-05-14\"\r\n    }\r\n  },\r\n  {\r\n    \"role\" : [{\r\n      \"coding\" : [{\r\n        \"system\" : \"http://snomed.info/sct\",\r\n        \"code\" : \"224535009\",\r\n        \"display\" : \"Registered nurse\"\r\n      }]\r\n    }],\r\n    \"member\" : {\r\n      \"type\" : \"Practitioner\",\r\n      \"identifier\" : {\r\n        \"use\" : \"official\",\r\n        \"system\" : \"https://standards.digital.health.nz/ns/hpi-practitioner-id\",\r\n        \"value\" : \"95ZZEJ\"\r\n      },\r\n      \"display\" : \"Felicity Faraway\"\r\n    },\r\n    \"onBehalfOf\" : {\r\n      \"type\" : \"Organization\",\r\n      \"identifier\" : {\r\n        \"use\" : \"official\",\r\n        \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\r\n        \"value\" : \"G0M744-C\"\r\n      },\r\n      \"display\" : \"Taranaki Rheumatic Fever Secondary Prevention Service\"\r\n    },\r\n    \"period\" : {\r\n      \"start\" : \"2024-05-14\"\r\n    }\r\n  }]\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/CareTeam",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"CareTeam"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create PatientMedicationAllergy QR (PMA)",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-PMAQRId\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"resourceType\" : \"QuestionnaireResponse\",\n  \"meta\" : {\n    \"versionId\" : \"2\",\n    \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\n    \"profile\" : [\"http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse\"],\n    \"tag\" : [{\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n      \"code\" : \"rf-nz\",\n      \"display\" : \"rheumatic fever\"\n    }]\n  },\n  \"basedOn\" : [{\n\t\t\"reference\": \"CarePlan/{{T-RFCarePlanId}}\"\n  }],\n  \"questionnaire\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/PatientMedicationAllergyQuestionnaire|1.0.0\",\n  \"status\" : \"completed\",\n  \"subject\" : {\n    \"type\" : \"Patient\",\n    \"identifier\" : {\n      \"use\" : \"official\",\n      \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\n      \"value\" : \"ZKC7284\"\n    },\n    \"display\" : \"Sage Westbrook\"\n  },\n  \"authored\" : \"2023-06-19T02:08:00.504Z\",\n  \"author\" : {\n    \"type\" : \"Organization\",\n    \"identifier\" : {\n      \"use\" : \"official\",\n      \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n      \"value\" : \"G0M086-B\"\n    },\n    \"display\" : \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n  },\n  \"item\" : [{\n    \"linkId\" : \"MedicationAllergies\",\n    \"text\" : \"Medication allergies? (Yes/No/Unknown)\",\n    \"answer\" : [{\n      \"valueCoding\" : {\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"373066001\",\n        \"display\" : \"Yes (qualifier value)\"\n      }\n    }]\n  },\n  {\n    \"linkId\" : \"AllergyDetails\",\n    \"text\" : \"If yes, select which substances apply\",\n    \"answer\" : [{\n      \"valueCoding\" : {\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"91931000\",\n        \"display\" : \"Allergy to erythromycin\"\n      }\n    },\n    {\n      \"valueCoding\" : {\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"419511003\",\n        \"display\" : \"Propensity to adverse reactions to drug (finding)\"\n      }\n    }]\n  }]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/QuestionnaireResponse",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"QuestionnaireResponse"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create MedicationsAndFollowUpGuidance QR (MFUG)",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-MFUGQRId\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"resourceType\": \"QuestionnaireResponse\",\n\t\"meta\": {\n\t\t\"versionId\": \"2\",\n\t\t\"lastUpdated\": \"2024-08-07T08:31:00Z\",\n\t\t\"profile\": [\n\t\t\t\"http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse\"\n\t\t],\n\t\t\"tag\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t}\n\t\t]\n\t},\n\t\"basedOn\": [\n\t\t{\n\t\t\t\"reference\": \"CarePlan/{{T-RFCarePlanId}}\"\n\t\t}\n\t],\n\t\"questionnaire\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/MedicationsAndFollowUpGuidanceQuestionnaire|1.0.0\",\n\t\"status\": \"completed\",\n\t\"subject\": {\n\t\t\"type\": \"Patient\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n\t\t\t\"value\": \"ZKC7284\"\n\t\t},\n\t\t\"display\": \"Sage Westbrook\"\n\t},\n\t\"authored\": \"2024-06-20T04:00:00Z\",\n\t\"author\": {\n\t\t\"type\": \"Organization\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n\t\t\t\"value\": \"G0M086-B\"\n\t\t},\n\t\t\"display\": \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n\t},\n\t\"item\": [\n\t\t{\n\t\t\t\"linkId\": \"SourceOfOralMedications\",\n\t\t\t\"text\": \"Source of oral medications? (choose one)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Monthly visit from a nurse\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"CaseOnWarfarin\",\n\t\t\t\"text\": \"Case on warfarin? (Yes/No/Unknown)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueCoding\": {\n\t\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\t\"code\": \"373066001\",\n\t\t\t\t\t\t\"display\": \"Yes (qualifier value)\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"WarfarinSupervisionService\",\n\t\t\t\"text\": \"Warfarin supervision service (choose one)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Pharmacy\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"MonitoringResultSource\",\n\t\t\t\"text\": \"International normalised ratio (INR) monitoring result source (choose one)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Éclair\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"FollowUpClinicalService\",\n\t\t\t\"text\": \"Follow-up clinical service? (choose one)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"GP\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"PrescribingMethod\",\n\t\t\t\"text\": \"Method of prescribing (choose one)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Standing Order (local)\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/QuestionnaireResponse",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"QuestionnaireResponse"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create PatientWhanauGoalsPreferences QR (PWGOAL)",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-PWGOALQRId\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"resourceType\": \"QuestionnaireResponse\",\n\t\"meta\": {\n\t\t\"versionId\": \"2\",\n\t\t\"lastUpdated\": \"2024-08-07T08:31:00Z\",\n\t\t\"profile\": [\n\t\t\t\"http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse\"\n\t\t],\n\t\t\"tag\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t}\n\t\t]\n\t},\n\t\"basedOn\": [\n\t\t{\n\t\t\t\"reference\": \"CarePlan/{{T-RFCarePlanId}}\"\n\t\t}\n\t],\n\t\"questionnaire\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/PatientWhanauGoalsPreferencesQuestionnaire|1.0.0\",\n\t\"status\": \"completed\",\n\t\"subject\": {\n\t\t\"type\": \"Patient\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n\t\t\t\"value\": \"ZKC7284\"\n\t\t},\n\t\t\"display\": \"Sage Westbrook\"\n\t},\n\t\"authored\": \"2023-06-19T03:08:00.504Z\",\n\t\"author\": {\n\t\t\"type\": \"Organization\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n\t\t\t\"value\": \"G0M086-B\"\n\t\t},\n\t\t\"display\": \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n\t},\n\t\"item\": [\n\t\t{\n\t\t\t\"linkId\": \"ImportantToMe\",\n\t\t\t\"text\": \"What things that are important to me and my family that support my health and wellbeing? (enter text)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"I want to avoid getting rheumatic heart disease so I can take over from Dad running our adventure tourism company, when he wants to retire.\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"WhanauInvolvement\",\n\t\t\t\"text\": \"How would I like my whanau and support persons to be involved? (enter text)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"I want my sisters to be with me at the injection appointments to support and distract me.\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"BestWayToCommunicate\",\n\t\t\t\"text\": \"The best way to communicate with me is…? (choose one)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"text message\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"AppointmentsContact\",\n\t\t\t\"text\": \"I know who to contact about my appointments? (choose one)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueBoolean\": true\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"PreferredAppointmentsLocation\",\n\t\t\t\"text\": \"What location do I prefer to receive injected antibiotics at? (choose one)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Home\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"InjectionLocationDetail\",\n\t\t\t\"text\": \"More detail about this location (eg. at school during term time, but at home with Dad if out of term time)? (enter text)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"We have an emu on our property which can be quite aggressive on Wednesdays and Thursdays in summer and doesn't like Audis so watch out for that!\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"ImportantDuringInjectionVisits\",\n\t\t\t\"text\": \"What things that are important to me during my injection visits eg. karakia, kaiawhina support? (enter text)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"I appreciate having chats with the district nurse at my appointments and I find this helps distract me from the injections\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"InjectionVisitsNoNos\",\n\t\t\t\"text\": \"What things don't work well for me during my injection visits? (enter text)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"I prefer not to know anything about the dose of medication in my injections.\\nAlso I don't like having the injection in the same part of my thigh on each appointment.  It would be good if the nurse can mix it up a bit.\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"MakingInjectionsComfortable\",\n\t\t\t\"text\": \"What things do I like to have with my injections to make them more comfortable? (multiple choice)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Lignocaine\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Ice pack\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Numbing spray\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Distraction\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"InjectionOtherComfort\",\n\t\t\t\"text\": \"What other things make my injections more comfortable? (enter text)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Ice cream always works well!\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"MedsPreferredSupplyMethod\",\n\t\t\t\"text\": \"I would prefer to get my oral antibiotic medicines from? (choose one)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Other\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"MedsSupplyOtherDetail\",\n\t\t\t\"text\": \"If other, enter details\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Please can you supply my medications in two-month packs?\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"EasierToGetToAppointments\",\n\t\t\t\"text\": \"What things make it easier for me to get to hospital appointments? (multiple choice)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Morning appointments\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"HospitalAppointmentsImportant\",\n\t\t\t\"text\": \"More detail about the things that are important to me about hospital appointments (enter text)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"I would like my hospital injections in a room with a view of the mountains.\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"HospitalAppointmentsNoNos\",\n\t\t\t\"text\": \"Things that don't work well for me about hospital appointments (enter text)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"I prefer it if there are not heaps of trainee medics watching me get my injections.\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"SupportGettingToHospitalAppointments\",\n\t\t\t\"text\": \"Do I need support getting to and from hospital appointment? (choose one)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"No\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"HospitalAppointmentsTransportSupport\",\n\t\t\t\"text\": \"Which transport support option do I need? (choose one)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Other\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"linkId\": \"HospitalAppointmentsTransportOtherDetail\",\n\t\t\t\"text\": \"What other details are there about getting to hospital appointments? (enter text)\",\n\t\t\t\"answer\": [\n\t\t\t\t{\n\t\t\t\t\t\"valueString\": \"Please can I have a reserved park space to park Dad's '73 Hilux?  This will help me get to my appointments on time.\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/QuestionnaireResponse",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"QuestionnaireResponse"
											]
										}
									},
									"response": []
								},
								{
									"name": "Update RF CarePlan to as-registered content with initial refs",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-RFCarePlanId\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"resourceType\": \"CarePlan\",\n\t\"id\": \"{{T-RFCarePlanId}}\",\n\t\"meta\": {\n\t\t\"versionId\": \"2\",\n\t\t\"lastUpdated\": \"2024-08-07T08:31:00Z\",\n\t\t\"profile\": [\n\t\t\t\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-careplan|1.0.0\"\n\t\t],\n\t\t\"tag\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t}\n\t\t]\n\t},\n\t\"extension\": [\n\t\t{\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-careplan-lifelongSecondaryProphylaxis\",\n\t\t\t\"valueBoolean\": false\n\t\t},\n\t\t{\n\t\t\t\"extension\": [\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"toStatus\",\n\t\t\t\t\t\"valueCoding\": {\n\t\t\t\t\t\t\"system\": \"http://hl7.org/fhir/request-status\",\n\t\t\t\t\t\t\"code\": \"draft\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"changeDate\",\n\t\t\t\t\t\"valueDate\": \"2023-06-19\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"changeReason\",\n\t\t\t\t\t\"valueString\": \"new patient\"\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-careplan-statusHistory\"\n\t\t}\n\t],\n\t\"identifier\": [\n\t\t{\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n\t\t\t\"value\": \"ZKC7284\"\n\t\t},\n\t\t{\n\t\t\t\"use\": \"usual\",\n\t\t\t\"type\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\t\"code\": \"rfccs-careplan-id\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n\t\t\t\"value\": \"00073693\"\n\t\t}\n\t],\n\t\"status\": \"draft\",\n\t\"intent\": \"plan\",\n\t\"category\": [\n\t\t{\n\t\t\t\"coding\": [\n\t\t\t\t{\n\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"title\": \"Care plan in initial state after Sage Westbrook registered\",\n\t\"subject\": {\n\t\t\"reference\": \"Patient/SageWestbrook\",\n\t\t\"type\": \"Patient\"\n\t},\n\t\"period\": {\n\t\t\"start\": \"2023-08-01T00:00:00Z\",\n\t\t\"end\": \"2033-07-31T00:00:00Z\"\n\t},\n\t\"created\": \"2023-06-12T00:00:00Z\",\n\t\"author\": {\n\t\t\"type\": \"Organization\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n\t\t\t\"value\": \"G0M086-B\"\n\t\t},\n\t\t\"display\": \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n\t},\n\t\"careTeam\": [\n\t\t{\n\t\t\t\"reference\": \"CareTeam/{{T-RFProphylaxisCareTeamId}}\"\n\t\t}\n\t],\n\t\"addresses\": [\n\t\t{\n\t\t\t\"reference\": \"Condition/{{T-Condition}}\",\n\t\t\t\"type\": \"Condition\"\n\t\t}\n\t],\n\t\"supportingInfo\": [\n\t\t{\n\t\t\t\"reference\": \"QuestionnaireResponse/{{T-PMAQRId}}\"\n\t\t},\n\t\t{\n\t\t\t\"reference\": \"QuestionnaireResponse/{{T-MFUGQRId}}\"\n\t\t},\n\t\t{\n\t\t\t\"reference\": \"QuestionnaireResponse/{{T-PWGOALQRId}}\"\n\t\t}\n\t]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/CarePlan/{{T-RFCarePlanId}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"CarePlan",
												"{{T-RFCarePlanId}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "Get Existing Consent Payload",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"pm.test(\"Check result is Consent \", () => {\r",
													"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
													"});\r",
													"\r",
													"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Consent/{{T-RFConsentId}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Consent",
												"{{T-RFConsentId}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "Link Consent to new RF instances",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"// get existing consent payload from prior step\r",
													"const consent = JSON.parse(pm.environment.get(\"T-RFConsent\"));\r",
													"\r",
													"// Create the empty array so the first data reference element can be pushed \r",
													"consent.provision.data = [];\r",
													"\r",
													"// 1\r",
													"var newRelativeRef = \"Patient/\" + pm.environment.get(\"T-RFPatientId\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef\r",
													"\t}\r",
													"});\r",
													"\r",
													"// 2\r",
													"newRelativeRef = \"Condition/\" + pm.environment.get(\"T-Condition\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef\r",
													"\t}\r",
													"});\r",
													"\r",
													"\r",
													"// 3\r",
													"newRelativeRef = \"CareTeam/\" + pm.environment.get(\"T-RFProphylaxisCareTeamId\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef\r",
													"\t}\r",
													"});\r",
													"\r",
													"// 4\r",
													"newRelativeRef = \"QuestionnaireResponse/\" + pm.environment.get(\"T-PMAQRId\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef\r",
													"\t}\r",
													"});\r",
													"\r",
													"// 5\r",
													"newRelativeRef = \"QuestionnaireResponse/\" + pm.environment.get(\"T-MFUGQRId\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef\r",
													"\t}\r",
													"});\r",
													"\r",
													"\r",
													"// 6\r",
													"newRelativeRef = \"QuestionnaireResponse/\" + pm.environment.get(\"T-PWGOALQRId\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef\r",
													"\t}\r",
													"});\r",
													"\r",
													"\r",
													"// 7\r",
													"newRelativeRef = \"CarePlan/\" + pm.environment.get(\"T-RFCarePlanId\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef \r",
													"\t}\r",
													"});\r",
													"\r",
													"\r",
													"// \r",
													"pm.environment.set(\"T-RFConsent-Update-Payload\",JSON.stringify(consent));\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{{T-RFConsent-Update-Payload}}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Consent/{{T-RFConsentId}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Consent",
												"{{T-RFConsentId}}"
											]
										}
									},
									"response": []
								}
							]
						}
					]
				},
				{
					"name": "Detailed Diagnosis and Planning",
					"item": [
						{
							"name": "Add Diagnosis details",
							"item": [
								{
									"name": "Create Diagnosis Encounter",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-DiagnosticEncounter\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"let date = new Date();\r",
													"pm.variables.set(\"CURRENT_DATE\", date.toISOString().slice(0, 10));\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\r\n  \"resourceType\" : \"Encounter\",\r\n  \"meta\" : {\r\n    \"versionId\" : \"2\",\r\n    \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\r\n    \"profile\" : [\"http://hl7.org/fhir/StructureDefinition/Encounter\"],\r\n    \"tag\" : [{\r\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\r\n      \"code\" : \"rf-nz\",\r\n      \"display\" : \"rheumatic fever\"\r\n    }]\r\n  },\r\n  \"contained\" : [{\r\n    \"resourceType\" : \"Location\",\r\n    \"id\" : \"PublicHospital\",\r\n    \"meta\" : {\r\n      \"profile\" : [\"http://hl7.org.nz/fhir/StructureDefinition/NzLocation\"]\r\n    },\r\n    \"identifier\" : [{\r\n      \"use\" : \"official\",\r\n      \"system\" : \"https://standards.digital.health.nz/ns/hpi-facility-id\",\r\n      \"value\" : \"FZZ933-E\"\r\n    }],\r\n    \"name\" : \"Public Hospital\",\r\n    \"type\" : [{\r\n      \"coding\" : [{\r\n        \"system\" : \"http://terminology.hl7.org/CodeSystem/v3-RoleCode\",\r\n        \"code\" : \"HOSP\"\r\n      }]\r\n    }]\r\n  },\r\n  {\r\n    \"resourceType\" : \"Location\",\r\n    \"id\" : \"SageWestbrookHomeAddress\",\r\n    \"meta\" : {\r\n      \"profile\" : [\"http://hl7.org.nz/fhir/StructureDefinition/NzLocation\"]\r\n    },\r\n    \"identifier\" : [{\r\n      \"use\" : \"usual\",\r\n      \"system\" : \"https://standards.digital.health.nz/ns/nz-address-id\",\r\n      \"value\" : \"123456\"\r\n    }],\r\n    \"name\" : \"Sage's Home\",\r\n    \"address\" : {\r\n      \"use\" : \"home\",\r\n      \"text\" : \"19 Bayside Lane, Parua Bay, Whangārei 0174, New Zealand\",\r\n      \"line\" : [\"19 Bayside Lane\",\r\n      \"Parua Bay\"],\r\n      \"city\" : \"Whangārei\",\r\n      \"postalCode\" : \"0174\",\r\n      \"country\" : \"NZL\",\r\n      \"period\" : {\r\n        \"start\" : \"2023-08-01\"\r\n      }\r\n    },\r\n    \"position\" : {\r\n      \"longitude\" : 174.481122,\r\n      \"latitude\" : -35.773725\r\n    }\r\n  },\r\n  {\r\n    \"resourceType\" : \"Location\",\r\n    \"id\" : \"WhangareiGirlsHighSchool\",\r\n    \"meta\" : {\r\n      \"profile\" : [\"http://hl7.org.nz/fhir/StructureDefinition/NzLocation\"]\r\n    },\r\n    \"identifier\" : [{\r\n      \"use\" : \"official\",\r\n      \"system\" : \"https://standards.digital.health.nz/ns/moe-facility-id\",\r\n      \"value\" : \"16\"\r\n    }],\r\n    \"name\" : \"Whangārei Girls’ High School\",\r\n    \"type\" : [{\r\n      \"coding\" : [{\r\n        \"system\" : \"http://terminology.hl7.org/CodeSystem/v3-RoleCode\",\r\n        \"code\" : \"SCHOOL\"\r\n      }]\r\n    }]\r\n  }],\r\n  \"status\" : \"finished\",\r\n  \"class\" : {\r\n    \"system\" : \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\r\n    \"code\" : \"AMB\",\r\n    \"display\" : \"ambulatory\"\r\n  },\r\n  \"type\" : [{\r\n    \"coding\" : [{\r\n      \"system\" : \"http://snomed.info/sct\",\r\n      \"code\" : \"58718002\",\r\n      \"display\" : \"Rheumatic fever (disorder)\"\r\n    }]\r\n  }],\r\n  \"serviceType\" : {\r\n    \"coding\" : [{\r\n      \"system\" : \"http://snomed.info/sct\",\r\n      \"code\" : \"22232009\",\r\n      \"display\" : \"Hospital (environment)\"\r\n    }]\r\n  },\r\n  \"subject\" : {\r\n    \"type\" : \"Patient\",\r\n    \"identifier\" : {\r\n      \"use\" : \"official\",\r\n      \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\r\n      \"value\" : \"ZKC7284\"\r\n    },\r\n    \"display\" : \"Sage Westbrook\"\r\n  },\r\n  \"participant\" : [{\r\n    \"individual\" : {\r\n      \"type\" : \"Patient\",\r\n      \"identifier\" : {\r\n        \"use\" : \"official\",\r\n        \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\r\n        \"value\" : \"ZKC7284\"\r\n      },\r\n      \"display\" : \"Sage Westbrook\"\r\n    }\r\n  }],\r\n  \"period\" : {\r\n    \"start\" : \"2023-03-12T02:00:00Z\"\r\n  },\r\n  \"location\" : [{\r\n    \"location\" : {\r\n      \"reference\" : \"#PublicHospital\"\r\n    }\r\n  },\r\n  {\r\n    \"location\" : {\r\n      \"reference\" : \"#SageWestbrookHomeAddress\"\r\n    }\r\n  },\r\n  {\r\n    \"location\" : {\r\n      \"reference\" : \"#WhangareiGirlsHighSchool\"\r\n    }\r\n  }],\r\n  \"serviceProvider\" : {\r\n    \"type\" : \"Organization\",\r\n    \"identifier\" : {\r\n      \"use\" : \"official\",\r\n      \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\r\n      \"value\" : \"G0M086-B\"\r\n    },\r\n    \"display\" : \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\r\n  }\r\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Encounter",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Encounter"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create ECHO diagnosis detail",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-ObservationECHO\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"resourceType\" : \"Observation\",\n  \"meta\" : {\n    \"versionId\" : \"2\",\n    \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\n    \"profile\" : [\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-diagnosisgroup\"],\n    \"tag\" : [{\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n      \"code\" : \"rf-nz\",\n      \"display\" : \"rheumatic fever\"\n    }]\n  },\n  \"identifier\" : [{\n    \"use\" : \"usual\",\n    \"type\" : {\n      \"coding\" : [{\n        \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n        \"code\" : \"rfccs-observation-id\"\n      }]\n    },\n    \"system\" : \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n    \"value\" : \"OBSD-0100\"\n  }],\n  \"status\" : \"final\",\n  \"code\" : {\n    \"coding\" : [{\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n      \"code\" : \"439238004\",\n      \"display\" : \"Echocardiography test interpretation (observable entity)\"\n    }]\n  },\n  \"subject\" : {\n    \"type\" : \"Patient\",\n    \"identifier\" : {\n      \"use\" : \"official\",\n      \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\n      \"value\" : \"ZKC7284\"\n    },\n    \"display\" : \"Sage Westbrook\"\n  },\n  \"encounter\" : {\n  \t\"reference\": \"Encounter/{{T-DiagnosticEncounter}}\"\n  },\n  \"effectiveDateTime\" : \"2023-06-02T02:00:00Z\",\n  \"performer\" : [{\n    \"type\" : \"Organization\",\n    \"identifier\" : {\n      \"use\" : \"official\",\n      \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n      \"value\" : \"G0M086-B\"\n    },\n    \"display\" : \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n  }],\n  \"note\" : [{\n    \"text\" : \"- Around and around and around with its own sound\\n- A sound that no one has to hear\"\n  }],\n  \"component\" : [{\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"48724000\",\n        \"display\" : \"Mitral valve regurgitation (disorder)\"\n      }],\n      \"text\" : \"{display}\"\n    },\n    \"valueCodeableConcept\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"1255665007\",\n        \"display\" : \"Moderate (qualifier value)\"\n      }],\n      \"text\" : \"Moderate (qualifier value)\"\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"79619009\",\n        \"display\" : \"Mitral valve stenosis (disorder)\"\n      }],\n      \"text\" : \"{display}\"\n    },\n    \"valueCodeableConcept\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"24484000\",\n        \"display\" : \"Severe (severity modifier) (qualifier value)\"\n      }],\n      \"text\" : \"Severe (severity modifier) (qualifier value)\"\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"60234000\",\n        \"display\" : \"Aortic valve regurgitation (disorder)\"\n      }],\n      \"text\" : \"{display}\"\n    },\n    \"valueCodeableConcept\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"1255665007\",\n        \"display\" : \"Moderate (qualifier value)\"\n      }],\n      \"text\" : \"Moderate (qualifier value)\"\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"60573004\",\n        \"display\" : \"Aortic valve stenosis (disorder)\"\n      }],\n      \"text\" : \"{display}\"\n    },\n    \"valueCodeableConcept\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"24484000\",\n        \"display\" : \"Severe (severity modifier) (qualifier value)\"\n      }],\n      \"text\" : \"Severe (severity modifier) (qualifier value)\"\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"111287006\",\n        \"display\" : \"Tricuspid valve regurgitation (disorder)\"\n      }],\n      \"text\" : \"{display}\"\n    },\n    \"valueCodeableConcept\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"1255665007\",\n        \"display\" : \"Moderate (qualifier value)\"\n      }],\n      \"text\" : \"Moderate (qualifier value)\"\n    }\n  }]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Observation",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Observation"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create JONES criteria diagnosis detail",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-ObservationJONES\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"resourceType\" : \"Observation\",\n  \"meta\" : {\n    \"versionId\" : \"2\",\n    \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\n    \"profile\" : [\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-diagnosisgroup\"],\n    \"tag\" : [{\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n      \"code\" : \"rf-nz\",\n      \"display\" : \"rheumatic fever\"\n    }]\n  },\n  \"identifier\" : [{\n    \"use\" : \"usual\",\n    \"type\" : {\n      \"coding\" : [{\n        \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n        \"code\" : \"rfccs-observation-id\"\n      }]\n    },\n    \"system\" : \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n    \"value\" : \"OBSD-0101\"\n  }],\n  \"status\" : \"final\",\n  \"code\" : {\n    \"coding\" : [{\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n      \"code\" : \"447541000210107\",\n      \"display\" : \"New Zealand Jones Criteria Assessment (observable entity)\"\n    }]\n  },\n  \"subject\" : {\n    \"type\" : \"Patient\",\n    \"identifier\" : {\n      \"use\" : \"official\",\n      \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\n      \"value\" : \"ZKC7284\"\n    },\n    \"display\" : \"Sage Westbrook\"\n  },\n  \"encounter\" : {\n \t\t\"reference\": \"Encounter/{{T-DiagnosticEncounter}}\"\n  },\n  \"performer\" : [{\n    \"type\" : \"Organization\",\n    \"identifier\" : {\n      \"use\" : \"official\",\n      \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n      \"value\" : \"G0M086-B\"\n    },\n    \"display\" : \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n  }],\n  \"component\" : [{\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"703119002\",\n        \"display\" : \"Carditis due to rheumatic fever (disorder)\"\n      }],\n      \"text\" : \"Carditis due to rheumatic fever (disorder)\"\n    },\n    \"valueBoolean\" : true\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n        \"code\" : \"448021000210106\",\n        \"display\" : \"Indolent carditis (disorder)\"\n      }],\n      \"text\" : \"Indolent carditis (disorder)\"\n    },\n    \"valueBoolean\" : true\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"95325000\",\n        \"display\" : \"Subcutaneous nodule (finding)\"\n      }],\n      \"text\" : \"Subcutaneous nodule (finding)\"\n    },\n    \"valueBoolean\" : false\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"200951007\",\n        \"display\" : \"Erythema marginatum in acute rheumatic fever (disorder)\"\n      }],\n      \"text\" : \"Erythema marginatum in acute rheumatic fever (disorder)\"\n    },\n    \"dataAbsentReason\" : {\n      \"coding\" : [{\n        \"system\" : \"http://terminology.hl7.org/CodeSystem/data-absent-reason\",\n        \"code\" : \"unknown\",\n        \"display\" : \"Unknown\"\n      }]\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"111211002\",\n        \"display\" : \"Migratory polyarthritis (disorder)\"\n      }],\n      \"text\" : \"Migratory polyarthritis (disorder)\"\n    },\n    \"valueBoolean\" : true\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"699462004\",\n        \"display\" : \"Monoarthritis (disorder)\"\n      }],\n      \"text\" : \"Monoarthritis (disorder)\"\n    },\n    \"dataAbsentReason\" : {\n      \"coding\" : [{\n        \"system\" : \"http://terminology.hl7.org/CodeSystem/data-absent-reason\",\n        \"code\" : \"unknown\",\n        \"display\" : \"Unknown\"\n      }]\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"46826000\",\n        \"display\" : \"Rheumatic chorea (disorder)\"\n      }],\n      \"text\" : \"Rheumatic chorea (disorder)\"\n    },\n    \"valueBoolean\" : true\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"35678005\",\n        \"display\" : \"Multiple joint pain (finding)\"\n      }],\n      \"text\" : \"Multiple joint pain (finding)\"\n    },\n    \"valueBoolean\" : true\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"165468009\",\n        \"display\" : \"Erythrocyte sedimentation rate above reference range (finding)\"\n      }],\n      \"text\" : \"Erythrocyte sedimentation rate above reference range (finding)\"\n    },\n    \"valueBoolean\" : true\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"416838001\",\n        \"display\" : \"Erythrocyte sedimentation rate measurement (procedure)\"\n      }],\n      \"text\" : \"Erythrocyte sedimentation rate measurement (procedure)\"\n    },\n    \"valueQuantity\" : {\n      \"value\" : 30,\n      \"unit\" : \"mm/h\",\n      \"system\" : \"http://unitsofmeasure.org\",\n      \"code\" : \"mm/h\"\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"119971000119104\",\n        \"display\" : \"C-reactive protein above reference range (finding)\"\n      }],\n      \"text\" : \"C-reactive protein above reference range (finding)\"\n    },\n    \"valueBoolean\" : true\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"55235003\",\n        \"display\" : \"C-reactive protein measurement (procedure)\"\n      }],\n      \"text\" : \"C-reactive protein measurement (procedure)\"\n    },\n    \"valueQuantity\" : {\n      \"value\" : 12,\n      \"unit\" : \"mg/l\",\n      \"system\" : \"http://unitsofmeasure.org\",\n      \"code\" : \"mg/L\"\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"251207006\",\n        \"display\" : \"PR interval duration (observable entity)\"\n      }],\n      \"text\" : \"PR interval duration (observable entity)\"\n    },\n    \"valueQuantity\" : {\n      \"value\" : 0.25,\n      \"unit\" : \"s\",\n      \"system\" : \"http://unitsofmeasure.org\",\n      \"code\" : \"s\"\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"164947007\",\n        \"display\" : \"Prolonged PR interval (finding)\"\n      }],\n      \"text\" : \"Prolonged PR interval (finding)\"\n    },\n    \"valueBoolean\" : true\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"386661006\",\n        \"display\" : \"Fever (finding)\"\n      }],\n      \"text\" : \"Fever (finding)\"\n    },\n    \"valueBoolean\" : true\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"44808001\",\n        \"display\" : \"Conduction disorder of the heart (disorder)\"\n      }],\n      \"text\" : \"Conduction disorder of the heart (disorder)\"\n    },\n    \"valueBoolean\" : true\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"44808001\",\n        \"display\" : \"Conduction disorder of the heart (disorder)\"\n      }],\n      \"text\" : \"Conduction disorder of the heart (disorder)\"\n    },\n    \"valueString\" : \"Conduction was considered abnormally low in such a young patient\"\n  }]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Observation",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Observation"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create STREP primary diagnosis detail",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-ObservationSTREP\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"resourceType\" : \"Observation\",\n  \"meta\" : {\n    \"versionId\" : \"2\",\n    \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\n    \"profile\" : [\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-diagnosisgroup\"],\n    \"tag\" : [{\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n      \"code\" : \"rf-nz\",\n      \"display\" : \"rheumatic fever\"\n    }]\n  },\n  \"identifier\" : [{\n    \"use\" : \"usual\",\n    \"type\" : {\n      \"coding\" : [{\n        \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n        \"code\" : \"rfccs-observation-id\"\n      }]\n    },\n    \"system\" : \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n    \"value\" : \"OBSD-0102\"\n  }],\n  \"status\" : \"final\",\n  \"code\" : {\n    \"coding\" : [{\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n      \"code\" : \"448011000210101\",\n      \"display\" : \"Evidence of preceding Streptococcus group A infection\"\n    }]\n  },\n  \"subject\" : {\n    \"type\" : \"Patient\",\n    \"identifier\" : {\n      \"use\" : \"official\",\n      \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\n      \"value\" : \"ZKC7284\"\n    },\n    \"display\" : \"Sage Westbrook\"\n  },\n  \"encounter\" : {\n\t\t\"reference\": \"Encounter/{{T-DiagnosticEncounter}}\"\n  },\n  \"performer\" : [{\n    \"type\" : \"Organization\",\n    \"identifier\" : {\n      \"use\" : \"official\",\n      \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n      \"value\" : \"G0M086-B\"\n    },\n    \"display\" : \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n  }],\n  \"hasMember\" : [{\n    \"reference\" : \"Observation/DiagnosisDetail-StrepEvidence-Secondary\"\n  }],\n  \"component\" : [{\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"82703001\",\n        \"display\" : \"Antistreptolysin O titer (procedure)\"\n      }],\n      \"text\" : \"Antistreptolysin O titer (procedure)\"\n    },\n    \"valueQuantity\" : {\n      \"value\" : 480000,\n      \"unit\" : \"IU/litre\",\n      \"system\" : \"http://unitsofmeasure.org\",\n      \"code\" : \"[iU]/L\"\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"82703001\",\n        \"display\" : \"Antistreptolysin O titer (procedure)\"\n      }],\n      \"text\" : \"Antistreptolysin O titer (procedure)\"\n    },\n    \"valueDateTime\" : \"2023-06-02T02:00:00Z\"\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"394723001\",\n        \"display\" : \"Anti-deoxyribonuclease B antibody level (procedure)\"\n      }],\n      \"text\" : \"Anti-deoxyribonuclease B antibody level (procedure)\"\n    },\n    \"valueQuantity\" : {\n      \"value\" : 680000,\n      \"unit\" : \"IU/litre\",\n      \"system\" : \"http://unitsofmeasure.org\",\n      \"code\" : \"[iU]/L\"\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"394723001\",\n        \"display\" : \"Anti-deoxyribonuclease B antibody level (procedure)\"\n      }],\n      \"text\" : \"Anti-deoxyribonuclease B antibody level (procedure)\"\n    },\n    \"valueDateTime\" : \"2023-06-02T02:00:00Z\"\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"117015009\",\n        \"display\" : \"Throat culture (procedure)\"\n      }],\n      \"text\" : \"Throat culture (procedure)\"\n    },\n    \"dataAbsentReason\" : {\n      \"coding\" : [{\n        \"system\" : \"http://terminology.hl7.org/CodeSystem/data-absent-reason\",\n        \"code\" : \"not-performed\",\n        \"display\" : \"Not performed\"\n      }]\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"9718006\",\n        \"display\" : \"Polymerase chain reaction analysis (procedure)\"\n      }],\n      \"text\" : \"Polymerase chain reaction analysis (procedure)\"\n    },\n    \"interpretation\" : [{\n      \"coding\" : [{\n        \"system\" : \"http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation\",\n        \"code\" : \"POS\",\n        \"display\" : \"Positive\"\n      }]\n    }]\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"312504002\",\n        \"display\" : \"Antigen test (procedure)\"\n      }],\n      \"text\" : \"Antigen test (procedure)\"\n    },\n    \"dataAbsentReason\" : {\n      \"coding\" : [{\n        \"system\" : \"http://terminology.hl7.org/CodeSystem/data-absent-reason\",\n        \"code\" : \"unknown\",\n        \"display\" : \"Unknown\"\n      }]\n    }\n  }]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Observation",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Observation"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create STREP secondary diagnosis detail",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-ObservationSTREP2\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"resourceType\" : \"Observation\",\n  \"meta\" : {\n    \"versionId\" : \"2\",\n    \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\n    \"profile\" : [\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-diagnosisgroup\"],\n    \"tag\" : [{\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n      \"code\" : \"rf-nz\",\n      \"display\" : \"rheumatic fever\"\n    }]\n  },\n  \"identifier\" : [{\n    \"use\" : \"usual\",\n    \"type\" : {\n      \"coding\" : [{\n        \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n        \"code\" : \"rfccs-observation-id\"\n      }]\n    },\n    \"system\" : \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n    \"value\" : \"OBSD-0103\"\n  }],\n  \"status\" : \"final\",\n  \"code\" : {\n    \"coding\" : [{\n      \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n      \"code\" : \"448011000210101\",\n      \"display\" : \"Evidence of preceding Streptococcus group A infection\"\n    }]\n  },\n  \"subject\" : {\n    \"type\" : \"Patient\",\n    \"identifier\" : {\n      \"use\" : \"official\",\n      \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\n      \"value\" : \"ZKC7284\"\n    },\n    \"display\" : \"Sage Westbrook\"\n  },\n\t\"encounter\" : {\n\t\t\"reference\": \"Encounter/{{T-DiagnosticEncounter}}\"\n\t},\n\t\"performer\": [\n\t\t{\n\t\t\t\"type\": \"Organization\",\n\t\t\t\"identifier\": {\n\t\t\t\t\"use\": \"official\",\n\t\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n\t\t\t\t\"value\": \"G0M086-B\"\n\t\t\t},\n\t\t\t\"display\": \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n\t\t}\n\t],\n\t\"derivedFrom\": [\n\t\t{\n\t\t\t\"reference\": \"Observation/{{T-ObservationSTREP}}\"\n\t\t}\n\t],\n  \"component\" : [{\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"82703001\",\n        \"display\" : \"Antistreptolysin O titer (procedure)\"\n      }],\n      \"text\" : \"Antistreptolysin O titer (procedure)\"\n    },\n    \"valueQuantity\" : {\n      \"value\" : 480000,\n      \"unit\" : \"IU/litre\",\n      \"system\" : \"http://unitsofmeasure.org\",\n      \"code\" : \"[iU]/L\"\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"82703001\",\n        \"display\" : \"Antistreptolysin O titer (procedure)\"\n      }],\n      \"text\" : \"Antistreptolysin O titer (procedure)\"\n    },\n    \"valueDateTime\" : \"2023-06-02T02:00:00Z\"\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"394723001\",\n        \"display\" : \"Anti-deoxyribonuclease B antibody level (procedure)\"\n      }],\n      \"text\" : \"Anti-deoxyribonuclease B antibody level (procedure)\"\n    },\n    \"valueQuantity\" : {\n      \"value\" : 680000,\n      \"unit\" : \"IU/litre\",\n      \"system\" : \"http://unitsofmeasure.org\",\n      \"code\" : \"[iU]/L\"\n    }\n  },\n  {\n    \"code\" : {\n      \"coding\" : [{\n        \"system\" : \"http://snomed.info/sct\",\n        \"code\" : \"394723001\",\n        \"display\" : \"Anti-deoxyribonuclease B antibody level (procedure)\"\n      }],\n      \"text\" : \"Anti-deoxyribonuclease B antibody level (procedure)\"\n    },\n    \"valueDateTime\" : \"2023-06-02T02:00:00Z\"\n  }]\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Observation",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Observation"
											]
										}
									},
									"response": []
								},
								{
									"name": "Update STREP primary with hasMember secondary link",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"// const id = pm.response.json().id;\r",
													"// pm.environment.set(\"T-ObservationSTREP\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"resourceType\": \"Observation\",\n\t\"id\": \"{{T-ObservationSTREP}}\",\n\t\"meta\": {\n\t\t\"versionId\": \"2\",\n\t\t\"lastUpdated\": \"2024-08-07T08:31:00Z\",\n\t\t\"profile\": [\n\t\t\t\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-diagnosisgroup\"\n\t\t],\n\t\t\"tag\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t}\n\t\t]\n\t},\n\t\"identifier\": [\n\t\t{\n\t\t\t\"use\": \"usual\",\n\t\t\t\"type\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\t\"code\": \"rfccs-observation-id\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n\t\t\t\"value\": \"OBSD-0102\"\n\t\t}\n\t],\n\t\"status\": \"final\",\n\t\"code\": {\n\t\t\"coding\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"448011000210101\",\n\t\t\t\t\"display\": \"Evidence of preceding Streptococcus group A infection\"\n\t\t\t}\n\t\t]\n\t},\n\t\"subject\": {\n\t\t\"type\": \"Patient\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n\t\t\t\"value\": \"ZKC7284\"\n\t\t},\n\t\t\"display\": \"Sage Westbrook\"\n\t},\n\t\"encounter\": {\n\t\t\"reference\": \"Encounter/{{T-DiagnosticEncounter}}\"\n\t},\n\t\"performer\": [\n\t\t{\n\t\t\t\"type\": \"Organization\",\n\t\t\t\"identifier\": {\n\t\t\t\t\"use\": \"official\",\n\t\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n\t\t\t\t\"value\": \"G0M086-B\"\n\t\t\t},\n\t\t\t\"display\": \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n\t\t}\n\t],\n\t\"hasMember\": [\n\t\t{\n\t\t\t\"reference\": \"Observation/{{T-ObservationSTREP2}}\"\n\t\t}\n\t],\n\t\"component\": [\n\t\t{\n\t\t\t\"code\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\t\"code\": \"82703001\",\n\t\t\t\t\t\t\"display\": \"Antistreptolysin O titer (procedure)\"\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t\"text\": \"Antistreptolysin O titer (procedure)\"\n\t\t\t},\n\t\t\t\"valueQuantity\": {\n\t\t\t\t\"value\": 480000,\n\t\t\t\t\"unit\": \"IU/litre\",\n\t\t\t\t\"system\": \"http://unitsofmeasure.org\",\n\t\t\t\t\"code\": \"[iU]/L\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"code\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\t\"code\": \"82703001\",\n\t\t\t\t\t\t\"display\": \"Antistreptolysin O titer (procedure)\"\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t\"text\": \"Antistreptolysin O titer (procedure)\"\n\t\t\t},\n\t\t\t\"valueDateTime\": \"2023-06-02T02:00:00Z\"\n\t\t},\n\t\t{\n\t\t\t\"code\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\t\"code\": \"394723001\",\n\t\t\t\t\t\t\"display\": \"Anti-deoxyribonuclease B antibody level (procedure)\"\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t\"text\": \"Anti-deoxyribonuclease B antibody level (procedure)\"\n\t\t\t},\n\t\t\t\"valueQuantity\": {\n\t\t\t\t\"value\": 680000,\n\t\t\t\t\"unit\": \"IU/litre\",\n\t\t\t\t\"system\": \"http://unitsofmeasure.org\",\n\t\t\t\t\"code\": \"[iU]/L\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"code\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\t\"code\": \"394723001\",\n\t\t\t\t\t\t\"display\": \"Anti-deoxyribonuclease B antibody level (procedure)\"\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t\"text\": \"Anti-deoxyribonuclease B antibody level (procedure)\"\n\t\t\t},\n\t\t\t\"valueDateTime\": \"2023-06-02T02:00:00Z\"\n\t\t},\n\t\t{\n\t\t\t\"code\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\t\"code\": \"117015009\",\n\t\t\t\t\t\t\"display\": \"Throat culture (procedure)\"\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t\"text\": \"Throat culture (procedure)\"\n\t\t\t},\n\t\t\t\"dataAbsentReason\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://terminology.hl7.org/CodeSystem/data-absent-reason\",\n\t\t\t\t\t\t\"code\": \"not-performed\",\n\t\t\t\t\t\t\"display\": \"Not performed\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"code\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\t\"code\": \"9718006\",\n\t\t\t\t\t\t\"display\": \"Polymerase chain reaction analysis (procedure)\"\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t\"text\": \"Polymerase chain reaction analysis (procedure)\"\n\t\t\t},\n\t\t\t\"interpretation\": [\n\t\t\t\t{\n\t\t\t\t\t\"coding\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"system\": \"http://terminology.hl7.org/CodeSystem/v3-ObservationInterpretation\",\n\t\t\t\t\t\t\t\"code\": \"POS\",\n\t\t\t\t\t\t\t\"display\": \"Positive\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"code\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\t\"code\": \"312504002\",\n\t\t\t\t\t\t\"display\": \"Antigen test (procedure)\"\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\t\"text\": \"Antigen test (procedure)\"\n\t\t\t},\n\t\t\t\"dataAbsentReason\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://terminology.hl7.org/CodeSystem/data-absent-reason\",\n\t\t\t\t\t\t\"code\": \"unknown\",\n\t\t\t\t\t\t\"display\": \"Unknown\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Observation/{{T-ObservationSTREP}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Observation",
												"{{T-ObservationSTREP}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "Get Existing Consent Payload",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"pm.test(\"Check result is Consent \", () => {\r",
													"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
													"});\r",
													"\r",
													"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Consent/{{T-RFConsentId}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Consent",
												"{{T-RFConsentId}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "Link Consent to new instances",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"// get existing consent payload from prior step\r",
													"const consent = JSON.parse(pm.environment.get(\"T-RFConsent\"));\r",
													"\r",
													"// 1\r",
													"newRelativeRef = \"Encounter/\" + pm.environment.get(\"T-DiagnosticEncounter\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef\r",
													"\t}\r",
													"});\r",
													"\r",
													"// 2\r",
													"newRelativeRef = \"Observation/\" + pm.environment.get(\"T-ObservationECHO\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef\r",
													"\t}\r",
													"});\r",
													"\r",
													"// 3\r",
													"newRelativeRef = \"Observation/\" + pm.environment.get(\"T-ObservationJONES\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef\r",
													"\t}\r",
													"});\r",
													"\r",
													"// 4\r",
													"newRelativeRef = \"Observation/\" + pm.environment.get(\"T-ObservationSTREP\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef\r",
													"\t}\r",
													"});\r",
													"\r",
													"// 5\r",
													"newRelativeRef = \"Observation/\" + pm.environment.get(\"T-ObservationSTREP2\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef\r",
													"\t}\r",
													"});\r",
													"\r",
													"// \r",
													"pm.environment.set(\"T-RFConsent-Update-Payload\",JSON.stringify(consent));\r",
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{{T-RFConsent-Update-Payload}}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Consent/{{T-RFConsentId}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Consent",
												"{{T-RFConsentId}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "Update Condition with diagnosis evidence and links",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"// const id = pm.response.json().id;\r",
													"// pm.environment.set(\"T-ObservationSTREP\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"resourceType\": \"Condition\",\n\t\"id\": \"{{T-Condition}}\",\n\t\"meta\": {\n\t\t\"versionId\": \"2\",\n\t\t\"lastUpdated\": \"2024-08-07T08:31:00Z\",\n\t\t\"profile\": [\n\t\t\t\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-condition\"\n\t\t],\n\t\t\"tag\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t}\n\t\t]\n\t},\n\t\"extension\": [\n\t\t{\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-condition-rhdseverity\",\n\t\t\t\"valueCoding\": {\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"59391000119102\",\n\t\t\t\t\"display\": \"History of heart valve repair (situation)\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-condition-diagnosticcertainty\",\n\t\t\t\"valueCoding\": {\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"probable\",\n\t\t\t\t\"display\": \"probable\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-condition-assessmentdate\",\n\t\t\t\"valueDateTime\": \"2023-03-12T02:00:00Z\"\n\t\t},\n\t\t{\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-condition-symptomaticAtDiagnosis\",\n\t\t\t\"valueCoding\": {\n\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\"code\": \"264931009\",\n\t\t\t\t\"display\": \"Symptomatic (qualifier value)\"\n\t\t\t}\n\t\t}\n\t],\n\t\"identifier\": [\n\t\t{\n\t\t\t\"use\": \"usual\",\n\t\t\t\"type\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\t\"code\": \"rfccs-condition-id\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n\t\t\t\"value\": \"CON-0206\"\n\t\t},\n\t\t{\n\t\t\t\"use\": \"usual\",\n\t\t\t\"type\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\t\"code\": \"episurv-number\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"system\": \"https://episurv.esr.cri.nz/\",\n\t\t\t\"value\": \"21-383414-AK\"\n\t\t}\n\t],\n\t\"clinicalStatus\": {\n\t\t\"coding\": [\n\t\t\t{\n\t\t\t\t\"system\": \"http://terminology.hl7.org/CodeSystem/condition-clinical\",\n\t\t\t\t\"code\": \"active\",\n\t\t\t\t\"display\": \"Active\"\n\t\t\t}\n\t\t],\n\t\t\"text\": \"Active\"\n\t},\n\t\"verificationStatus\": {\n\t\t\"coding\": [\n\t\t\t{\n\t\t\t\t\"system\": \"http://terminology.hl7.org/CodeSystem/condition-ver-status\",\n\t\t\t\t\"code\": \"confirmed\",\n\t\t\t\t\"display\": \"Confirmed\"\n\t\t\t}\n\t\t],\n\t\t\"text\": \"Confirmed\"\n\t},\n\t\"category\": [\n\t\t{\n\t\t\t\"coding\": [\n\t\t\t\t{\n\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\"code\": \"58718002\",\n\t\t\t\t\t\"display\": \"Rheumatic fever (disorder)\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"coding\": [\n\t\t\t\t{\n\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"severity\": {\n\t\t\"coding\": [\n\t\t\t{\n\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\"code\": \"24484000\",\n\t\t\t\t\"display\": \"Severe\"\n\t\t\t}\n\t\t]\n\t},\n\t\"code\": {\n\t\t\"coding\": [\n\t\t\t{\n\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\"code\": \"195528001\",\n\t\t\t\t\"display\": \"Acute rheumatic fever (disorder)\"\n\t\t\t}\n\t\t]\n\t},\n\t\"subject\": {\n\t\t\"type\": \"Patient\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n\t\t\t\"value\": \"ZKC7284\"\n\t\t},\n\t\t\"display\": \"Sage Westbrook\"\n\t},\n\t\"encounter\": {\n\t\t\"reference\": \"Encounter/{{T-DiagnosticEncounter}}\"\n\t},\n\t\"onsetDateTime\": \"2023-02-05T02:00:00Z\",\n\t\"recordedDate\": \"2023-03-12T02:00:00Z\",\n\t\"recorder\": {\n\t\t\"type\": \"Practitioner\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-practitioner-id\",\n\t\t\t\"value\": \"99ZZFX\"\n\t\t},\n\t\t\"display\": \"Dottie McStuffins\"\n\t},\n\t\"evidence\": [\n\t\t{\n\t\t\t\"code\": [\n\t\t\t\t{\n\t\t\t\t\t\"coding\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\t\t\"code\": \"439238004\",\n\t\t\t\t\t\t\t\"display\": \"Echocardiography test interpretation (observable entity)\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"detail\": [\n\t\t\t\t{\n\t\t\t\t\t\"reference\": \"Observation/{{T-ObservationECHO}}\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"code\": [\n\t\t\t\t{\n\t\t\t\t\t\"coding\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\t\t\"code\": \"447541000210107\",\n\t\t\t\t\t\t\t\"display\": \"New Zealand Jones Criteria Assessment (observable entity)\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"detail\": [\n\t\t\t\t{\n\t\t\t\t\t\"reference\": \"Observation/{{T-ObservationJONES}}\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"code\": [\n\t\t\t\t{\n\t\t\t\t\t\"coding\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\t\t\"code\": \"448011000210101\",\n\t\t\t\t\t\t\t\"display\": \"Evidence of preceding Streptococcus group A infection (observation entity)\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"detail\": [\n\t\t\t\t{\n\t\t\t\t\t\"reference\": \"Observation/{{T-ObservationSTREP}}\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t]\n}\n",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Condition/{{T-Condition}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Condition",
												"{{T-Condition}}"
											]
										}
									},
									"response": []
								}
							]
						},
						{
							"name": "Plan medication and THREE appointments",
							"item": [
								{
									"name": "Create Medication",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-Medication\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"resourceType\": \"Medication\",\n\t\"id\": \"BenzathineMedication\",\n\t\"meta\": {\n\t\t\"versionId\": \"2\",\n\t\t\"lastUpdated\": \"2024-08-07T08:31:00Z\",\n\t\t\"profile\": [\n\t\t\t\"http://hl7.org/fhir/StructureDefinition/Medication\"\n\t\t],\n\t\t\"tag\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t}\n\t\t]\n\t},\n\t\"code\": {\n\t\t\"coding\": [\n\t\t\t{\n\t\t\t\t\"system\": \"http://nzmt.org.nz\",\n\t\t\t\t\"code\": \"43924201000116108\",\n\t\t\t\t\"display\": \"Bicillin LA 1.2 million units/2.3 mL (900 mg/2.3 mL) injection: suspension, 1 x 2.3 mL syringe\"\n\t\t\t}\n\t\t]\n\t},\n\t\"ingredient\": [\n\t\t{\n\t\t\t\"itemCodeableConcept\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://nzmt.org.nz\",\n\t\t\t\t\t\t\"code\": \"10134211000116105\",\n\t\t\t\t\t\t\"display\": \"benzathine penicillin (as benzathine benzylpenicillin tetrahydrate)\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Medication",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Medication"
											]
										}
									},
									"response": []
								},
								{
									"name": "Plan 3 years of Benzathine and pain relief",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-MedicationRequest\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"resourceType\": \"MedicationRequest\",\n\t\"id\": \"PlannedBenzathineMedicationWithLignocaine\",\n\t\"meta\": {\n\t\t\"versionId\": \"2\",\n\t\t\"lastUpdated\": \"2024-08-07T08:31:00Z\",\n\t\t\"profile\": [\n\t\t\t\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-medicationrequest\"\n\t\t],\n\t\t\"tag\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t}\n\t\t]\n\t},\n\t\"contained\": [\n\t\t{\n\t\t\t\"resourceType\": \"MedicationRequest\",\n\t\t\t\"id\": \"contained-Lignocaine\",\n\t\t\t\"status\": \"active\",\n\t\t\t\"intent\": \"plan\",\n\t\t\t\"medicationCodeableConcept\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://nzmt.org.nz\",\n\t\t\t\t\t\t\"code\": \"10747581000116100\",\n\t\t\t\t\t\t\"display\": \"lidocaine hydrochloride anhydrous 1% (20 mg/2 mL) injection, ampoule\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"subject\": {\n\t\t\t\t\"type\": \"Patient\",\n\t\t\t\t\"identifier\": {\n\t\t\t\t\t\"use\": \"official\",\n\t\t\t\t\t\"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n\t\t\t\t\t\"value\": \"ZKC7284\"\n\t\t\t\t},\n\t\t\t\t\"display\": \"Sage Westbrook\"\n\t\t\t},\n\t\t\t\"basedOn\": [\n\t\t\t\t{\n\t\t\t\t\t\"reference\": \"#\"\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"dosageInstruction\": [\n\t\t\t\t{\n\t\t\t\t\t\"doseAndRate\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"doseQuantity\": {\n\t\t\t\t\t\t\t\t\"value\": 0.25,\n\t\t\t\t\t\t\t\t\"unit\": \"ml\",\n\t\t\t\t\t\t\t\t\"system\": \"http://unitsofmeasure.org\",\n\t\t\t\t\t\t\t\t\"code\": \"ml\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"extension\": [\n\t\t{\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-medicationrequest-medicationfrequency\",\n\t\t\t\"valueCoding\": {\n\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\"code\": \"1511000175108\",\n\t\t\t\t\"display\": \"Every twenty eight days (qualifier value)\"\n\t\t\t}\n\t\t}\n\t],\n\t\"status\": \"active\",\n\t\"intent\": \"plan\",\n\t\"medicationReference\": {\n\t\t\"reference\": \"Medication/{{T-Medication}}\"\n\t},\n\t\"subject\": {\n\t\t\"type\": \"Patient\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n\t\t\t\"value\": \"ZKC7284\"\n\t\t},\n\t\t\"display\": \"Sage Westbrook\"\n\t},\n\t\"authoredOn\": \"2023-07-12T04:22:55.965Z\",\n\t\"requester\": {\n\t\t\"type\": \"Organization\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n\t\t\t\"value\": \"G0M086-B\"\n\t\t},\n\t\t\"display\": \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n\t},\n\t\"performer\": {\n\t\t\"type\": \"Practitioner\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-practitioner-id\",\n\t\t\t\"value\": \"98ZZQJ\"\n\t\t},\n\t\t\"display\": \"Isabel Injecta\"\n\t},\n\t\"basedOn\": [\n\t\t{\n\t\t\t\"reference\": \"CarePlan/{{T-RFCarePlanId}}\"\n\t\t}\n\t],\n\t\"dosageInstruction\": [\n\t\t{\n\t\t\t\"site\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\t\"code\": \"78333006\",\n\t\t\t\t\t\t\"display\": \"Structure of gluteus medius muscle (body structure)\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"route\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\t\"code\": \"78421000\",\n\t\t\t\t\t\t\"display\": \"Intramuscular route (qualifier value)\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"doseAndRate\": [\n\t\t\t\t{\n\t\t\t\t\t\"doseQuantity\": {\n\t\t\t\t\t\t\"value\": 25,\n\t\t\t\t\t\t\"unit\": \"mg\",\n\t\t\t\t\t\t\"system\": \"http://unitsofmeasure.org\",\n\t\t\t\t\t\t\"code\": \"mg\"\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"dispenseRequest\": {\n\t\t\"validityPeriod\": {\n\t\t\t\"start\": \"2023-08-01T00:12:00Z\",\n\t\t\t\"end\": \"2026-07-31T00:12:00Z\"\n\t\t}\n\t}\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/MedicationRequest",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"MedicationRequest"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create August 2023 SP Appointment",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-AppointmentSPAugust\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"resourceType\": \"Appointment\",\n\t\"id\": \"SecondaryProphylaxisAppointment-August-Booked\",\n\t\"meta\": {\n\t\t\"versionId\": \"2\",\n\t\t\"lastUpdated\": \"2024-08-07T08:31:00Z\",\n\t\t\"profile\": [\n\t\t\t\"http://hl7.org/fhir/StructureDefinition/Appointment\"\n\t\t],\n\t\t\"tag\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t}\n\t\t]\n\t},\n\t\"identifier\": [\n\t\t{\n\t\t\t\"use\": \"usual\",\n\t\t\t\"type\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\t\"code\": \"rfccs-careplanactivity-id\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n\t\t\t\"value\": \"CPA-00073693-20230808\"\n\t\t}\n\t],\n\t\"status\": \"booked\",\n\t\"serviceCategory\": [\n\t\t{\n\t\t\t\"coding\": [\n\t\t\t\t{\n\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\"code\": \"58718002\",\n\t\t\t\t\t\"display\": \"Rheumatic fever (disorder)\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"serviceType\": [\n\t\t{\n\t\t\t\"coding\": [\n\t\t\t\t{\n\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\"code\": \"360271000\",\n\t\t\t\t\t\"display\": \"Prophylaxis - procedure intent (qualifier value)\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"description\": \"monthly injection August 2023\",\n\t\"supportingInformation\": [\n\t\t{\n\t\t\t\"type\": \"Organization\",\n\t\t\t\"identifier\": {\n\t\t\t\t\"use\": \"official\",\n\t\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n\t\t\t\t\"value\": \"G0M086-B\"\n\t\t\t},\n\t\t\t\"display\": \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n\t\t}\n\t],\n\t\"start\": \"2023-08-08T02:00:00Z\",\n\t\"end\": \"2023-08-08T03:00:00Z\",\n\t\"comment\": \"The plan for this appointment is...\",\n\t\"participant\": [\n\t\t{\n\t\t\t\"actor\": {\n\t\t\t\t\"type\": \"Patient\",\n\t\t\t\t\"identifier\": {\n\t\t\t\t\t\"use\": \"official\",\n\t\t\t\t\t\"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n\t\t\t\t\t\"value\": \"ZKC7284\"\n\t\t\t\t},\n\t\t\t\t\"display\": \"Sage Westbrook\"\n\t\t\t},\n\t\t\t\"status\": \"accepted\"\n\t\t},\n\t\t{\n\t\t\t\"actor\": {\n\t\t\t\t\"type\": \"Practitioner\",\n\t\t\t\t\"identifier\": {\n\t\t\t\t\t\"use\": \"official\",\n\t\t\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-practitioner-id\",\n\t\t\t\t\t\"value\": \"98ZZQJ\"\n\t\t\t\t},\n\t\t\t\t\"display\": \"Isabel Injecta\"\n\t\t\t},\n\t\t\t\"status\": \"accepted\"\n\t\t}\n\t]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Appointment",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Appointment"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create August 2023 Dental Follow-up Appointment",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-AppointmentFollowUpAugust\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"resourceType\": \"Appointment\",\n  \"id\": \"FollowUp-Dental-August-Booked\",\n  \"meta\": {\n    \"versionId\": \"2\",\n    \"lastUpdated\": \"2024-08-07T08:31:00Z\",\n    \"profile\": [\"http://hl7.org/fhir/StructureDefinition/Appointment\"],\n    \"tag\": [\n      {\n        \"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n        \"code\": \"rf-nz\",\n        \"display\": \"rheumatic fever\"\n      }\n    ]\n  },\n  \"identifier\": [\n    {\n      \"use\": \"usual\",\n      \"type\": {\n        \"coding\": [\n          {\n            \"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n            \"code\": \"rfccs-careplanactivity-id\"\n          }\n        ]\n      },\n      \"system\": \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n      \"value\": \"CPA-00073694-20231117\"\n    }\n  ],\n  \"status\": \"booked\",\n  \"serviceCategory\": [\n    {\n      \"coding\": [\n        {\n          \"system\": \"http://snomed.info/sct\",\n          \"code\": \"58718002\",\n          \"display\": \"Rheumatic fever (disorder)\"\n        }\n      ]\n    }\n  ],\n  \"serviceType\": [\n    {\n      \"coding\": [\n        {\n          \"system\": \"http://snomed.info/sct\",\n          \"code\": \"772071006\",\n          \"display\": \"Referral to dentist (procedure)\"\n        }\n      ]\n    }\n  ],\n  \"description\": \"dentist follow up August 2023\",\n  \"supportingInformation\": [\n    {\n      \"type\": \"Organization\",\n      \"identifier\": {\n        \"use\": \"official\",\n        \"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n        \"value\": \"GZZ851-K\"\n      },\n      \"display\": \"Extractive Dental Revenue Limited\"\n    }\n  ],\n  \"start\": \"2023-08-15T02:00:00Z\",\n  \"end\": \"2023-08-15T03:00:00Z\",\n  \"comment\": \"Specialist consult for Sage's rheumatic fever condition.\",\n  \"participant\": [\n    {\n      \"actor\": {\n        \"type\": \"Patient\",\n        \"identifier\": {\n          \"use\": \"official\",\n          \"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n          \"value\": \"ZKC7284\"\n        },\n        \"display\": \"Sage Westbrook\"\n      },\n      \"status\": \"accepted\"\n    }\n  ]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Appointment",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Appointment"
											]
										}
									},
									"response": []
								},
								{
									"name": "Create September 2023 Appointment",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(201);\r",
													"});\r",
													"\r",
													"const id = pm.response.json().id;\r",
													"pm.environment.set(\"T-AppointmentSPSeptember\", id);\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "POST",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n  \"resourceType\": \"Appointment\",\n  \"id\": \"SecondaryProphylaxisAppointment-September-Booked\",\n  \"meta\": {\n    \"versionId\": \"2\",\n    \"lastUpdated\": \"2024-08-07T08:31:00Z\",\n    \"profile\": [\"http://hl7.org/fhir/StructureDefinition/Appointment\"],\n    \"tag\": [\n      {\n        \"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n        \"code\": \"rf-nz\",\n        \"display\": \"rheumatic fever\"\n      }\n    ]\n  },\n  \"identifier\": [\n    {\n      \"use\": \"usual\",\n      \"type\": {\n        \"coding\": [\n          {\n            \"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n            \"code\": \"rfccs-careplanactivity-id\"\n          }\n        ]\n      },\n      \"system\": \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n      \"value\": \"CPA-00073693-20230905\"\n    }\n  ],\n  \"status\": \"booked\",\n  \"serviceCategory\": [\n    {\n      \"coding\": [\n        {\n          \"system\": \"http://snomed.info/sct\",\n          \"code\": \"58718002\",\n          \"display\": \"Rheumatic fever (disorder)\"\n        }\n      ]\n    }\n  ],\n  \"serviceType\": [\n    {\n      \"coding\": [\n        {\n          \"system\": \"http://snomed.info/sct\",\n          \"code\": \"360271000\",\n          \"display\": \"Prophylaxis - procedure intent (qualifier value)\"\n        }\n      ]\n    }\n  ],\n  \"description\": \"monthly injection September 2023\",\n  \"supportingInformation\": [\n    {\n      \"type\": \"Organization\",\n      \"identifier\": {\n        \"use\": \"official\",\n        \"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n        \"value\": \"G0M744-C\"\n      },\n      \"display\": \"Taranaki Rheumatic Fever Secondary Prevention Service\"\n    }\n  ],\n  \"start\": \"2023-09-05T02:00:00Z\",\n  \"end\": \"2023-09-05T03:00:00Z\",\n  \"comment\": \"This appointment will be carried out in Taranaki by the shared care provider.\",\n  \"participant\": [\n    {\n      \"actor\": {\n        \"type\": \"Patient\",\n        \"identifier\": {\n          \"use\": \"official\",\n          \"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n          \"value\": \"ZKC7284\"\n        },\n        \"display\": \"Sage Westbrook\"\n      },\n      \"status\": \"accepted\"\n    }\n  ]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Appointment",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Appointment"
											]
										}
									},
									"response": []
								},
								{
									"name": "Update CarePlan with activities linking to MR and Appointments",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n\t\"resourceType\": \"CarePlan\",\n\t\"id\": \"{{T-RFCarePlanId}}\",\n\t\"meta\": {\n\t\t\"versionId\": \"2\",\n\t\t\"lastUpdated\": \"2024-08-07T08:31:00Z\",\n\t\t\"profile\": [\n\t\t\t\"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-careplan|1.0.0\"\n\t\t],\n\t\t\"tag\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t}\n\t\t]\n\t},\n\t\"extension\": [\n\t\t{\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-careplan-lifelongSecondaryProphylaxis\",\n\t\t\t\"valueBoolean\": false\n\t\t},\n\t\t{\n\t\t\t\"extension\": [\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"toStatus\",\n\t\t\t\t\t\"valueCoding\": {\n\t\t\t\t\t\t\"system\": \"http://hl7.org/fhir/request-status\",\n\t\t\t\t\t\t\"code\": \"draft\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"changeDate\",\n\t\t\t\t\t\"valueDate\": \"2023-06-19\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"changeReason\",\n\t\t\t\t\t\"valueString\": \"new patient\"\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-careplan-statusHistory\"\n\t\t},\n\t\t{\n\t\t\t\"extension\": [\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"toStatus\",\n\t\t\t\t\t\"valueCoding\": {\n\t\t\t\t\t\t\"system\": \"http://hl7.org/fhir/request-status\",\n\t\t\t\t\t\t\"code\": \"active\"\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"changeDate\",\n\t\t\t\t\t\"valueDate\": \"2023-07-01\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"url\": \"changeReason\",\n\t\t\t\t\t\"valueString\": \"Initial secondary prophylaxis planned\"\n\t\t\t\t}\n\t\t\t],\n\t\t\t\"url\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/rf-careplan-statusHistory\"\n\t\t}\n\t],\n\t\"identifier\": [\n\t\t{\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n\t\t\t\"value\": \"ZKC7284\"\n\t\t},\n\t\t{\n\t\t\t\"use\": \"usual\",\n\t\t\t\"type\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\t\"code\": \"rfccs-careplan-id\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n\t\t\t\"value\": \"00073693\"\n\t\t}\n\t],\n\t\"status\": \"active\",\n\t\"intent\": \"plan\",\n\t\"category\": [\n\t\t{\n\t\t\t\"coding\": [\n\t\t\t\t{\n\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"title\": \"Care plan ready to go with all medication planned and appointments booked\",\n\t\"subject\": {\n\t\t\"reference\": \"Patient/SageWestbrook\",\n\t\t\"type\": \"Patient\"\n\t},\n\t\"period\": {\n\t\t\"start\": \"2023-08-01T00:00:00Z\",\n\t\t\"end\": \"2033-07-31T00:00:00Z\"\n\t},\n\t\"created\": \"2023-06-12T00:00:00Z\",\n\t\"author\": {\n\t\t\"type\": \"Organization\",\n\t\t\"identifier\": {\n\t\t\t\"use\": \"official\",\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n\t\t\t\"value\": \"G0M086-B\"\n\t\t},\n\t\t\"display\": \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n\t},\n\t\"careTeam\": [\n\t\t{\n\t\t\t\"reference\": \"CareTeam/{{T-RFProphylaxisCareTeamId}}\"\n\t\t}\n\t],\n\t\"addresses\": [\n\t\t{\n\t\t\t\"reference\": \"Condition/{{T-Condition}}\",\n\t\t\t\"type\": \"Condition\"\n\t\t}\n\t],\n\t\"supportingInfo\": [\n\t\t{\n\t\t\t\"reference\": \"QuestionnaireResponse/{{T-PMAQRId}}\"\n\t\t},\n\t\t{\n\t\t\t\"reference\": \"QuestionnaireResponse/{{T-MFUGQRId}}\"\n\t\t},\n\t\t{\n\t\t\t\"reference\": \"QuestionnaireResponse/{{T-PWGOALQRId}}\"\n\t\t}\n\t],\n\t\"activity\": [\n\t\t{\n\t\t\t\"reference\": {\n\t\t\t\t\"reference\": \"MedicationRequest/{{T-MedicationRequest}}\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"reference\": {\n\t\t\t\t\"reference\": \"Appointment/{{T-AppointmentSPAugust}}\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"reference\": {\n\t\t\t\t\"reference\": \"Appointment/{{T-AppointmentFollowUpAugust}}\"\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\t\"reference\": {\n\t\t\t\t\"reference\": \"Appointment/{{T-AppointmentSPSeptember}}\"\n\t\t\t}\n\t\t}\n\t]\n}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/CarePlan/{{T-RFCarePlanId}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"CarePlan",
												"{{T-RFCarePlanId}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "Get Existing Consent Payload",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"pm.test(\"Check result is Consent \", () => {\r",
													"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
													"});\r",
													"\r",
													"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
												],
												"type": "text/javascript"
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													""
												],
												"type": "text/javascript"
											}
										}
									],
									"protocolProfileBehavior": {
										"disableBodyPruning": true
									},
									"request": {
										"method": "GET",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}",
												"type": "text"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Consent/{{T-RFConsentId}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Consent",
												"{{T-RFConsentId}}"
											]
										}
									},
									"response": []
								},
								{
									"name": "Link Consent to Appointments",
									"event": [
										{
											"listen": "test",
											"script": {
												"exec": [
													"pm.test(\"Check status code\", () => {\r",
													"    pm.response.to.have.status(200);\r",
													"});\r",
													"\r",
													"// Add delay to allow ElasticSearch to update before running searches\r",
													"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										},
										{
											"listen": "prerequest",
											"script": {
												"exec": [
													"// get existing consent payload from prior step\r",
													"const consent = JSON.parse(pm.environment.get(\"T-RFConsent\"));\r",
													"\r",
													"var newRelativeRef;\r",
													"\r",
													"// Medication and MedicationRequest instances are not consent-protected so not linked here. \r",
													"\r",
													"// 1\r",
													"newRelativeRef = \"Appointment/\" + pm.environment.get(\"T-AppointmentSPAugust\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef \r",
													"\t}\r",
													"});\r",
													"\r",
													"// 2\r",
													"newRelativeRef = \"Appointment/\" + pm.environment.get(\"T-AppointmentFollowUpAugust\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef \r",
													"\t}\r",
													"});\r",
													"\r",
													"// 3\r",
													"newRelativeRef = \"Appointment/\" + pm.environment.get(\"T-AppointmentSPSeptember\");\r",
													"\r",
													"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
													"\r",
													"consent.provision.data.push({\r",
													"\tmeaning: \"instance\",\r",
													"\treference: {\r",
													"\t\treference: newRelativeRef \r",
													"\t}\r",
													"});\r",
													"\r",
													"pm.environment.set(\"T-RFConsent-Update-Payload\",JSON.stringify(consent));"
												],
												"type": "text/javascript",
												"packages": {}
											}
										}
									],
									"request": {
										"method": "PUT",
										"header": [
											{
												"key": "x-api-key",
												"value": "{{API_KEY}}"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{{T-RFConsent-Update-Payload}}",
											"options": {
												"raw": {
													"language": "json"
												}
											}
										},
										"url": {
											"raw": "{{API_URL}}/Consent/{{T-RFConsentId}}",
											"host": [
												"{{API_URL}}"
											],
											"path": [
												"Consent",
												"{{T-RFConsentId}}"
											]
										}
									},
									"response": []
								}
							]
						}
					]
				},
				{
					"name": "Secondary Prophylaxis Recording",
					"item": [
						{
							"name": "Create Bundle (Encounter, QR, MedStmt) v0.4.5",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"if(pm.response.json().entry.length < 3) {\r",
											"    throw new Error(\"Not enough instances created.  Please fix.\")\r",
											"}\r",
											"\r",
											"pm.test(\"Check 3 instances created\", () => {\r",
											"    pm.expect(pm.response.json().entry.length).to.equal(3);\r",
											"});\r",
											"\r",
											"// harvest resource instances ids for later use.\r",
											"// 1 of 3\r",
											"id = pm.response.json().entry[0].response.location.slice(-36);\r",
											"console.log( \"Got Encounter \" + id );\r",
											"pm.environment.set(\"T-August-Encounter\", id);\r",
											"\r",
											"// 2 of 3\r",
											"id = pm.response.json().entry[1].response.location.slice(-36);\r",
											"console.log( \"Got MedicationStatement \" + id );\r",
											"pm.environment.set(\"T-August-MedicationStatement\", id);\r",
											"\r",
											"// 3 of 3\r",
											"id = pm.response.json().entry[2].response.location.slice(-36);\r",
											"console.log( \"Got QuestionnaireResponse \" + id );\r",
											"pm.environment.set(\"T-August-QuestionnaireResponse\", id);\r",
											"\r",
											"\r",
											"// A hefty chunk of delay seems necessary here to let batch of update transactions complete\r",
											"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));\r",
											"\r",
											"\r",
											"\r",
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"resourceType\" : \"Bundle\",\n  \"meta\" : {\n    \"versionId\" : \"2\",\n    \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\n    \"profile\" : [\"http://hl7.org/fhir/StructureDefinition/Bundle\"]\n  },\n  \"type\" : \"transaction\",\n  \"entry\" : [{\n    \"fullUrl\" : \"http://example.org/fhir/Encounter/1001\",\n    \"resource\" : {\n      \"resourceType\" : \"Encounter\",\n      \"id\" : \"1001\",\n      \"meta\" : {\n        \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\n        \"profile\" : [\"http://hl7.org/fhir/StructureDefinition/Encounter\"],\n        \"tag\" : [{\n          \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n          \"code\" : \"rf-nz\",\n          \"display\" : \"rheumatic fever\"\n        }]\n      },\n      \"contained\" : [{\n        \"resourceType\" : \"Location\",\n        \"id\" : \"RedDiamondWhangarei\",\n        \"meta\" : {\n          \"profile\" : [\"http://hl7.org.nz/fhir/StructureDefinition/NzLocation\"]\n        },\n        \"identifier\" : [{\n          \"use\" : \"official\",\n          \"system\" : \"https://standards.digital.health.nz/ns/hpi-facility-id\",\n          \"value\" : \"FZZ860-D\"\n        }],\n        \"name\" : \"Red Diamond Generic Medical Centre- Whangarei\",\n        \"type\" : [{\n          \"coding\" : [{\n            \"system\" : \"http://terminology.hl7.org/CodeSystem/v3-RoleCode\",\n            \"code\" : \"PC\"\n          }]\n        }]\n      }],\n      \"status\" : \"finished\",\n      \"class\" : {\n        \"system\" : \"http://terminology.hl7.org/CodeSystem/v3-ActCode\",\n        \"code\" : \"AMB\",\n        \"display\" : \"ambulatory\"\n      },\n      \"type\" : [{\n        \"coding\" : [{\n          \"system\" : \"http://snomed.info/sct\",\n          \"code\" : \"58718002\",\n          \"display\" : \"Rheumatic fever (disorder)\"\n        }]\n      }],\n      \"serviceType\" : {\n        \"coding\" : [{\n          \"system\" : \"http://snomed.info/sct\",\n          \"code\" : \"360271000\",\n          \"display\" : \"Prophylaxis - procedure intent (qualifier value)\"\n        }]\n      },\n      \"subject\" : {\n        \"type\" : \"Patient\",\n        \"identifier\" : {\n          \"use\" : \"official\",\n          \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\n          \"value\" : \"ZKC7284\"\n        },\n        \"display\" : \"Sage Westbrook\"\n      },\n      \"participant\" : [{\n        \"individual\" : {\n          \"type\" : \"Practitioner\",\n          \"identifier\" : {\n            \"use\" : \"official\",\n            \"system\" : \"https://standards.digital.health.nz/ns/hpi-practitioner-id\",\n            \"value\" : \"98ZZQJ\"\n          },\n          \"display\" : \"Isabel Injecta\"\n        }\n      },\n      {\n        \"individual\" : {\n          \"type\" : \"Patient\",\n          \"identifier\" : {\n            \"use\" : \"official\",\n            \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\n            \"value\" : \"ZKC7284\"\n          },\n          \"display\" : \"Sage Westbrook\"\n        }\n      }],\n      \"appointment\" : [{\n\t\t\t\t\"reference\": \"Appointment/{{T-AppointmentSPAugust}}\"\n      }],\n      \"period\" : {\n        \"start\" : \"2023-08-08T02:10:00Z\",\n        \"end\" : \"2023-08-08T03:15:00Z\"\n      },\n      \"location\" : [{\n        \"location\" : {\n          \"reference\" : \"#RedDiamondWhangarei\"\n        }\n      }],\n      \"serviceProvider\" : {\n        \"type\" : \"Organization\",\n        \"identifier\" : {\n          \"use\" : \"official\",\n          \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n          \"value\" : \"GZZ866-A\"\n        },\n        \"display\" : \"Red Diamond Medical Limited\"\n      }\n    },\n    \"request\" : {\n      \"method\" : \"POST\",\n      \"url\" : \"Encounter\"\n    }\n  },\n  {\n    \"fullUrl\" : \"http://example.org/fhir/MedicationStatement/1002\",\n    \"resource\" : {\n      \"resourceType\" : \"MedicationStatement\",\n      \"id\" : \"1002\",\n      \"meta\" : {\n        \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\n        \"tag\" : [{\n          \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n          \"code\" : \"rf-nz\",\n          \"display\" : \"rheumatic fever\"\n        }]\n      },\n      \"contained\" : [{\n        \"resourceType\" : \"MedicationStatement\",\n        \"id\" : \"contained-Lignocaine-dose\",\n        \"partOf\" : [{\n          \"reference\" : \"MedicationStatement/MedicationStatement-August\"\n        }],\n        \"status\" : \"completed\",\n        \"medicationCodeableConcept\" : {\n          \"coding\" : [{\n            \"system\" : \"http://nzmt.org.nz\",\n            \"code\" : \"10747581000116100\",\n            \"display\" : \"lidocaine hydrochloride anhydrous 1% (20 mg/2 mL) injection, ampoule\"\n          }]\n        },\n        \"subject\" : {\n          \"type\" : \"Patient\",\n          \"identifier\" : {\n            \"use\" : \"official\",\n            \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\n            \"value\" : \"ZKC7284\"\n          },\n          \"display\" : \"Sage Westbrook\"\n        },\n        \"dosage\" : [{\n          \"doseAndRate\" : [{\n            \"doseQuantity\" : {\n              \"value\" : 0.25,\n              \"unit\" : \"ml\",\n              \"system\" : \"http://unitsofmeasure.org\",\n              \"code\" : \"ml\"\n            }\n          }]\n        }]\n      }],\n      \"basedOn\" : [{\n\t\t\t\t\"reference\": \"MedicationRequest/{{T-MedicationRequest}}\"\n      }],\n      \"partOf\" : [{\n        \"reference\" : \"#contained-Lignocaine-dose\"\n      }],\n      \"status\" : \"completed\",\n      \"category\" : {\n        \"coding\" : [{\n          \"system\" : \"http://snomed.info/sct\",\n          \"code\" : \"58718002\",\n          \"display\" : \"Rheumatic fever (disorder)\"\n        }]\n      },\n      \"medicationReference\" : {\n\t\t\t\t\"reference\": \"Medication/{{T-Medication}}\"\n      },\n      \"subject\" : {\n        \"type\" : \"Patient\",\n        \"identifier\" : {\n          \"use\" : \"official\",\n          \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\n          \"value\" : \"ZKC7284\"\n        },\n        \"display\" : \"Sage Westbrook\"\n      },\n      \"context\" : {\n        \"reference\" : \"http://example.org/fhir/Encounter/1\"\n      },\n      \"effectiveDateTime\" : \"2023-08-08T03:15:00Z\",\n      \"dateAsserted\" : \"2023-08-18T03:15:00Z\",\n      \"dosage\" : [{\n        \"site\" : {\n          \"coding\" : [{\n            \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n            \"code\" : \"299151000210101\",\n            \"display\" : \"Structure of left ventrogluteal region (body structure)\"\n          }]\n        },\n        \"route\" : {\n          \"coding\" : [{\n            \"system\" : \"http://snomed.info/sct\",\n            \"code\" : \"78421000\",\n            \"display\" : \"Intramuscular route (qualifier value)\"\n          }]\n        },\n        \"doseAndRate\" : [{\n          \"doseQuantity\" : {\n            \"value\" : 25,\n            \"unit\" : \"mg\",\n            \"system\" : \"http://unitsofmeasure.org\",\n            \"code\" : \"mg\"\n          }\n        }]\n      }]\n    },\n    \"request\" : {\n      \"method\" : \"POST\",\n      \"url\" : \"MedicationStatement\"\n    }\n  },\n  {\n    \"fullUrl\" : \"http://example.org/fhir/QuestionnaireResponse/1003\",\n    \"resource\" : {\n      \"resourceType\" : \"QuestionnaireResponse\",\n      \"id\" : \"1003\",\n      \"meta\" : {\n        \"lastUpdated\" : \"2024-08-07T08:31:00Z\",\n        \"profile\" : [\"http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse\"],\n        \"tag\" : [{\n          \"system\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n          \"code\" : \"rf-nz\",\n          \"display\" : \"rheumatic fever\"\n        }]\n      },\n      \"basedOn\" : [{\n\t\t\t\t\"reference\": \"CarePlan/{{T-RFCarePlanId}}\"\n      }],\n      \"questionnaire\" : \"https://fhir-ig.digital.health.nz/rheumatic-fever/Questionnaire/SecondaryProphylaxisHealthAssessmentQuestionnaire\",\n      \"status\" : \"completed\",\n      \"subject\" : {\n        \"type\" : \"Patient\",\n        \"identifier\" : {\n          \"use\" : \"official\",\n          \"system\" : \"https://standards.digital.health.nz/ns/nhi-id\",\n          \"value\" : \"ZKC7284\"\n        },\n        \"display\" : \"Sage Westbrook\"\n      },\n      \"encounter\" : {\n        \"reference\" : \"http://example.org/fhir/Encounter/1\"\n      },\n      \"authored\" : \"2023-08-08T01:08:00.504Z\",\n      \"author\" : {\n        \"type\" : \"Organization\",\n        \"identifier\" : {\n          \"use\" : \"official\",\n          \"system\" : \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n          \"value\" : \"G0M086-B\"\n        },\n        \"display\" : \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n      },\n      \"item\" : [{\n        \"linkId\" : \"ReasonsInjectionOverdue\",\n        \"text\" : \"Reason(s) injection was give late? (multiple choice)\",\n        \"answer\" : [{\n          \"valueString\" : \"Patient Not Available on the Day\"\n        },\n        {\n          \"valueString\" : \"Other\"\n        }]\n      },\n      {\n        \"linkId\" : \"OverdueInjectionOtherDetail\",\n        \"text\" : \"Other details for late injection (enter text)\",\n        \"answer\" : [{\n          \"valueString\" : \"The patient couldn't find a park for the classic Hilux.\"\n        }]\n      },\n      {\n        \"linkId\" : \"OtherPainManagementToolsUsed\",\n        \"text\" : \"Pain management tools used? (multiple choice)\",\n        \"answer\" : [{\n          \"valueString\" : \"Ice pack\"\n        },\n        {\n          \"valueString\" : \"Numbing spray\"\n        },\n        {\n          \"valueString\" : \"Distraction\"\n        },\n        {\n          \"valueString\" : \"Other\"\n        }]\n      },\n      {\n        \"linkId\" : \"PainManagementOtherDetails\",\n        \"text\" : \"Details of other pain management (enter text)\",\n        \"answer\" : [{\n          \"valueString\" : \"We discovered in this appointment that Chocolate Chip Cookie ice cream helps a lot!\"\n        }]\n      },\n      {\n        \"linkId\" : \"PostInjectionConcern\",\n        \"text\" : \"Post injection concern or possible reaction identified?\",\n        \"answer\" : [{\n          \"valueBoolean\" : true\n        }]\n      },\n      {\n        \"linkId\" : \"PostInjectionConcernDetails\",\n        \"text\" : \"If Yes, Record Details, Symptoms, Actions Taken and Follow-Up Plan (enter text)\",\n        \"answer\" : [{\n          \"valueString\" : \"Sage had a bit more than the usual sensitivity at the injection site so we dished out extra ice cream, which was nice.\"\n        }]\n      },\n      {\n        \"linkId\" : \"AnyOtherConcerns\",\n        \"text\" : \"Were There Any Other Concerns or Issues Identified During the Visit?\",\n        \"answer\" : [{\n          \"valueBoolean\" : true\n        }]\n      },\n      {\n        \"linkId\" : \"OtherConcernsDetail\",\n        \"text\" : \"If yes, describe details, actions taken, and follow-up planned (enter text)\",\n        \"answer\" : [{\n          \"valueString\" : \"A shortage of ice cream in our freezer led to some unnecessary worries for Sage.\"\n        }]\n      },\n      {\n        \"linkId\" : \"HealthEducationTopicsDiscussed\",\n        \"text\" : \"Health education topics discussed? (multiple choice)\",\n        \"answer\" : [{\n          \"valueString\" : \"Secondary prophylaxis\"\n        },\n        {\n          \"valueString\" : \"Nutrition\"\n        },\n        {\n          \"valueString\" : \"Other\"\n        }]\n      },\n      {\n        \"linkId\" : \"HealthEducationOtherDetail\",\n        \"text\" : \"Enter details of other health education topic discussed (enter text)\",\n        \"answer\" : [{\n          \"valueString\" : \"Sage and I discussed the importance of punctuality and the benefits of planning ahead.\"\n        }]\n      },\n      {\n        \"linkId\" : \"RecentOrUpcomingAppointments\",\n        \"text\" : \"Any recent or upcoming follow-up appointments?\",\n        \"answer\" : [{\n          \"valueBoolean\" : true\n        }]\n      },\n      {\n        \"linkId\" : \"RecentOrUpcomingAppointmentsDetails\",\n        \"text\" : \"Enter details and dates of any recent or upcoming follow-up appointments (enter text)\",\n        \"answer\" : [{\n          \"valueString\" : \"Sage has an upcoming follow-up appointment covering iOS calendar basics\"\n        }]\n      },\n      {\n        \"linkId\" : \"PlanForNextMedicationAppointment\",\n        \"text\" : \"Comments for the next appointment (enter text)\",\n        \"answer\" : [{\n          \"valueString\" : \"The plan for the next medication appointment is to keep up the good work\"\n        }]\n      }]\n    },\n    \"request\" : {\n      \"method\" : \"POST\",\n      \"url\" : \"QuestionnaireResponse\"\n    }\n  }]\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}",
									"host": [
										"{{API_URL}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Existing Consent Payload",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/Consent/{{T-RFConsentId}}",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"Consent",
										"{{T-RFConsentId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Link Consent to August things",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"// Add enough delay to allow ElasticSearch to update Consent so subsequent GETs / searches work\r",
											"setTimeout(function(){}, 5000);\r",
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											"// get existing consent payload from prior step\r",
											"const consent = JSON.parse(pm.environment.get(\"T-RFConsent\"));\r",
											"\r",
											"var newRelativeRef;\r",
											"\r",
											"// NOTE: Only SP Encounter and QR linked here because MedicationStatement instances are not Consent-protected.\r",
											"\r",
											"// 1 Encounter\r",
											"\r",
											"newRelativeRef = \"Encounter/\" + pm.environment.get(\"T-August-Encounter\");\r",
											"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
											"consent.provision.data.push({\r",
											"\tmeaning: \"instance\",\r",
											"\treference: {\r",
											"\t\treference: newRelativeRef\r",
											"\t}\r",
											"});\r",
											"\r",
											"// 2 QR\r",
											"newRelativeRef = \"QuestionnaireResponse/\" + pm.environment.get(\"T-August-QuestionnaireResponse\");\r",
											"console.log(\"Linking Consent to instance:\" + newRelativeRef);\r",
											"consent.provision.data.push({\r",
											"\tmeaning: \"instance\",\r",
											"\treference: {\r",
											"\t\treference: newRelativeRef\r",
											"\t}\r",
											"});\r",
											"\r",
											"// Update Consent resource\r",
											"pm.environment.set(\"T-RFConsent-Update-Payload\",JSON.stringify(consent));\r",
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{{T-RFConsent-Update-Payload}}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/Consent/{{T-RFConsentId}}",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"Consent",
										"{{T-RFConsentId}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Update August 2023 SP Appointment",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"// Add delay to allow ElasticSearch to update before running searches\r",
											"setTimeout(function(){}, pm.environment.get(\"ResourceCreationDelayMillis\"));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n\t\"resourceType\": \"Appointment\",\n\t\"id\": \"{{T-AppointmentSPAugust}}\",\n\t\"meta\": {\n\t\t\"versionId\": \"2\",\n\t\t\"lastUpdated\": \"2024-08-07T08:31:00Z\",\n\t\t\"profile\": [\n\t\t\t\"http://hl7.org/fhir/StructureDefinition/Appointment\"\n\t\t],\n\t\t\"tag\": [\n\t\t\t{\n\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\"code\": \"rf-nz\",\n\t\t\t\t\"display\": \"rheumatic fever\"\n\t\t\t}\n\t\t]\n\t},\n\t\"identifier\": [\n\t\t{\n\t\t\t\"use\": \"usual\",\n\t\t\t\"type\": {\n\t\t\t\t\"coding\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"system\": \"https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem\",\n\t\t\t\t\t\t\"code\": \"rfccs-careplanactivity-id\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t\"system\": \"https://standards.digital.health.nz/ns/rf-ccs-id\",\n\t\t\t\"value\": \"CPA-00073693-20230808\"\n\t\t}\n\t],\n\t\"status\": \"fulfilled\",\n\t\"serviceCategory\": [\n\t\t{\n\t\t\t\"coding\": [\n\t\t\t\t{\n\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\"code\": \"58718002\",\n\t\t\t\t\t\"display\": \"Rheumatic fever (disorder)\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"serviceType\": [\n\t\t{\n\t\t\t\"coding\": [\n\t\t\t\t{\n\t\t\t\t\t\"system\": \"http://snomed.info/sct\",\n\t\t\t\t\t\"code\": \"360271000\",\n\t\t\t\t\t\"display\": \"Prophylaxis - procedure intent (qualifier value)\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"description\": \"monthly injection August 2023\",\n\t\"supportingInformation\": [\n\t\t{\n\t\t\t\"type\": \"Organization\",\n\t\t\t\"identifier\": {\n\t\t\t\t\"use\": \"official\",\n\t\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-organisation-id\",\n\t\t\t\t\"value\": \"G0M086-B\"\n\t\t\t},\n\t\t\t\"display\": \"Te Tai Tokerau Rheumatic Fever Secondary Prevention Service\"\n\t\t},\n\t\t{\n\t\t\t\"reference\": \"Encounter/{{T-August-Encounter}}\"\n\t\t}\n\t],\n\t\"start\": \"2023-08-08T02:00:00Z\",\n\t\"end\": \"2023-08-08T03:00:00Z\",\n\t\"comment\": \"The plan for this appointment is...\",\n\t\"participant\": [\n\t\t{\n\t\t\t\"actor\": {\n\t\t\t\t\"type\": \"Patient\",\n\t\t\t\t\"identifier\": {\n\t\t\t\t\t\"use\": \"official\",\n\t\t\t\t\t\"system\": \"https://standards.digital.health.nz/ns/nhi-id\",\n\t\t\t\t\t\"value\": \"ZKC7284\"\n\t\t\t\t},\n\t\t\t\t\"display\": \"Sage Westbrook\"\n\t\t\t},\n\t\t\t\"status\": \"accepted\"\n\t\t},\n\t\t{\n\t\t\t\"actor\": {\n\t\t\t\t\"type\": \"Practitioner\",\n\t\t\t\t\"identifier\": {\n\t\t\t\t\t\"use\": \"official\",\n\t\t\t\t\t\"system\": \"https://standards.digital.health.nz/ns/hpi-practitioner-id\",\n\t\t\t\t\t\"value\": \"98ZZQJ\"\n\t\t\t\t},\n\t\t\t\t\"display\": \"Isabel Injecta\"\n\t\t\t},\n\t\t\t\"status\": \"accepted\"\n\t\t}\n\t]\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/Appointment/{{T-AppointmentSPAugust}}",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"Appointment",
										"{{T-AppointmentSPAugust}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "Get Encounter back",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/Encounter/{{T-August-Encounter}}",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"Encounter",
										"{{T-August-Encounter}}"
									]
								}
							},
							"response": []
						}
					]
				}
			]
		},
		{
			"name": "Canned queries",
			"item": [
				{
					"name": "Bundle GETs",
					"item": [
						{
							"name": "GET registration (Patient, Condition, CareTeam)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"resourceType\": \"Bundle\",\n  \"type\": \"batch\",\n  \"entry\": [\n    {\n      \"request\": {\n        \"method\": \"GET\",\n        \"url\": \"Patient/{{T-RFPatientId}}\"\n      }\n    },\n    {\n      \"request\": {\n        \"method\": \"GET\",\n        \"url\": \"CarePlan/{{T-RFCarePlanId}}\"\n      }\n    },\n    {\n      \"request\": {\n        \"method\": \"GET\",\n        \"url\": \"CareTeam/{{T-RFLeadProvidersGroupId}}\"\n      }\n    }\n  ]\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}",
									"host": [
										"{{API_URL}}"
									]
								}
							},
							"response": []
						},
						{
							"name": "GET August SP (Encounter, MedStmt, QR)",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript"
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"resourceType\": \"Bundle\",\n  \"type\": \"batch\",\n  \"entry\": [\n    {\n      \"request\": {\n        \"method\": \"GET\",\n        \"url\": \"MedicationStatement/{{T-RF-SP-August-MedicationStatementId}}\"\n      }\n    },\n    {\n      \"request\": {\n        \"method\": \"GET\",\n        \"url\": \"Encounter/{{T-RF-SP-August-EncounterId}}\"\n      }\n    },\n    {\n      \"request\": {\n        \"method\": \"GET\",\n        \"url\": \"QuestionnaireResponse/{{T-RF-SP-August-QuestionnaireResponseId}}\"\n      }\n    }\n  ]\n}",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}",
									"host": [
										"{{API_URL}}"
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "scoped retrieval",
					"item": [
						{
							"name": "GET Appointments by tag",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/Appointment?_tag=https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"Appointment"
									],
									"query": [
										{
											"key": "_tag",
											"value": "https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET RFPatient using RF profile",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/Patient?_profile=https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-patient|1.0.0",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"Patient"
									],
									"query": [
										{
											"key": "_profile",
											"value": "https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-patient|1.0.0"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET CarePlan by profile",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/CarePlan?_profile=https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-careplan|1.0.0",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"CarePlan"
									],
									"query": [
										{
											"key": "_profile",
											"value": "https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-careplan|1.0.0"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET SP CareTeam by tag",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/CareTeam?_tag=https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"CareTeam"
									],
									"query": [
										{
											"key": "_tag",
											"value": "https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET Condition by profile",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/Condition?_profile=https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-condition",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"Condition"
									],
									"query": [
										{
											"key": "_profile",
											"value": "https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-condition"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET Encounters by tag",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/Encounter?_tag=https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"Encounter"
									],
									"query": [
										{
											"key": "_tag",
											"value": "https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET MedicationRequests by profile",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/MedicationRequest?_profile=https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-medicationrequest",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"MedicationRequest"
									],
									"query": [
										{
											"key": "_profile",
											"value": "https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-medicationrequest"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET MedicationStatements by tag",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/MedicationStatement?_tag=https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"MedicationStatement"
									],
									"query": [
										{
											"key": "_tag",
											"value": "https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET DiagnosisGroup (Observations) by profile",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/Observation?_profile=https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-diagnosisgroup",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"Observation"
									],
									"query": [
										{
											"key": "_profile",
											"value": "https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-diagnosisgroup"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "GET QuestionnaireResponses by tag",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result is Consent \", () => {\r",
											"  pm.expect(pm.response.json().resourceType).to.equal(\"Consent\");\r",
											"});\r",
											"\r",
											"pm.environment.set(\"T-RFConsent\", JSON.stringify(pm.response.json()));"
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"protocolProfileBehavior": {
								"disableBodyPruning": true
							},
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "",
									"options": {
										"raw": {
											"language": "json"
										}
									}
								},
								"url": {
									"raw": "{{API_URL}}/QuestionnaireResponse?_tag=https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"QuestionnaireResponse"
									],
									"query": [
										{
											"key": "_tag",
											"value": "https://fhir-ig.digital.health.nz/rheumatic-fever/CodeSystem/nz-rheumaticfever-codesystem|rf-nz"
										}
									]
								}
							},
							"response": []
						}
					]
				},
				{
					"name": "Find Care Plan",
					"item": [
						{
							"name": "GET RFCarePlan by patient NHI identifier",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"  pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result count\", () => {\r",
											"  pm.expect(pm.response.json().total).to.be.above(0);\r",
											"});\r",
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{API_URL}}/CarePlan?_profile=https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-careplan|1.0.0&identifier=https://standards.digital.health.nz/ns/nhi-id|ZKC7284",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"CarePlan"
									],
									"query": [
										{
											"key": "_profile",
											"value": "https://fhir-ig.digital.health.nz/rheumatic-fever/StructureDefinition/nz-rheumaticfever-careplan|1.0.0"
										},
										{
											"key": "identifier",
											"value": "https://standards.digital.health.nz/ns/nhi-id|ZKC7284"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "2.3.3. Get CarePlan + its Activities",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result count\", () => {\r",
											"  pm.expect(pm.response.json().total).to.be.above(0);\r",
											"});\r",
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{API_URL}}/CarePlan?_id={{T-RFCarePlanId}}&_include=CarePlan:activity-reference",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"CarePlan"
									],
									"query": [
										{
											"key": "_id",
											"value": "{{T-RFCarePlanId}}"
										},
										{
											"key": "_include",
											"value": "CarePlan:activity-reference"
										}
									]
								}
							},
							"response": []
						},
						{
							"name": "2.3.4. Get CarePlan + All Child Resources",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"pm.test(\"Check status code\", () => {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"pm.test(\"Check result count\", () => {\r",
											"  pm.expect(pm.response.json().total).to.be.above(0);\r",
											"});\r",
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"exec": [
											""
										],
										"type": "text/javascript",
										"packages": {}
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [
									{
										"key": "x-api-key",
										"value": "{{API_KEY}}",
										"type": "text"
									}
								],
								"url": {
									"raw": "{{API_URL}}/CarePlan?_id={{T-RFCarePlanId}}&_include=*",
									"host": [
										"{{API_URL}}"
									],
									"path": [
										"CarePlan"
									],
									"query": [
										{
											"key": "_id",
											"value": "{{T-RFCarePlanId}}"
										},
										{
											"key": "_include",
											"value": "*"
										}
									]
								}
							},
							"response": []
						}
					]
				}
			]
		}
	],
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{OAUTH_TOKEN}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Include Request-Context on all requests",
					"pm.request.headers.add({key: 'Request-Context', value: 'ewogICJ1c2VySWRlbnRpZmllciI6ICIxMUFBYmJAIyIsCiAgInB1cnBvc2VPZlVzZSI6ICJQT1BITFRIIiwKICAidXNlckZ1bGxOYW1lIjogIlJvc2llIChSaGV1bWF0aWMgRmV2ZXIgQ29vcmRpbmF0b3IpIiwKICAiaHBpT3JnYW5pc2F0aW9uIjogewogICAgInR5cGUiOiAiT3JnYW5pemF0aW9uIiwKICAgICJpZGVudGlmaWVyIjogewogICAgICAidXNlIjogIm9mZmljaWFsIiwKICAgICAgInN5c3RlbSI6ICJodHRwczovL3N0YW5kYXJkcy5kaWdpdGFsLmhlYWx0aC5uei9ucy9ocGktb3JnYW5pc2F0aW9uLWlkIiwKICAgICAgInZhbHVlIjogIkcwTTA4Ni1CIgogICAgfSwKICAgICJkaXNwbGF5IjogIlRlIFRhaSBUb2tlcmF1IFJoZXVtYXRpYyBGZXZlciBTZWNvbmRhcnkgUHJldmVudGlvbiBTZXJ2aWNlIgogIH0KfQ==' });",
					"",
					"pm.environment.set(\"REQUEST-CONTEXT\",'ewogICJ1c2VySWRlbnRpZmllciI6ICIxMUFBYmJAIyIsCiAgInB1cnBvc2VPZlVzZSI6ICJQT1BITFRIIiwKICAidXNlckZ1bGxOYW1lIjogIlJvc2llIChSaGV1bWF0aWMgRmV2ZXIgQ29vcmRpbmF0b3IpIiwKICAiaHBpT3JnYW5pc2F0aW9uIjogewogICAgInR5cGUiOiAiT3JnYW5pemF0aW9uIiwKICAgICJpZGVudGlmaWVyIjogewogICAgICAidXNlIjogIm9mZmljaWFsIiwKICAgICAgInN5c3RlbSI6ICJodHRwczovL3N0YW5kYXJkcy5kaWdpdGFsLmhlYWx0aC5uei9ucy9ocGktb3JnYW5pc2F0aW9uLWlkIiwKICAgICAgInZhbHVlIjogIkcwTTA4Ni1CIgogICAgfSwKICAgICJkaXNwbGF5IjogIlRlIFRhaSBUb2tlcmF1IFJoZXVtYXRpYyBGZXZlciBTZWNvbmRhcnkgUHJldmVudGlvbiBTZXJ2aWNlIgogIH0KfQ=='",
					");",
					"",
					"utils = {",
					"    checkResourceIdentifierUnique: function(pm, resourceType, identifier) {",
					"        const url = `${pm.environment.get(\"API_URL\")}/${resourceType}?identifier=${identifier}`",
					"        const getRequest = {",
					"        url,",
					"        method: 'GET',",
					"        header: {",
					"            'Authorization': pm.environment.get(\"OAUTH_TOKEN\"),",
					"            'x-api-key': pm.environment.get(\"API_KEY\"),",
					"            'Request-Context': pm.environment.get(\"REQUEST-CONTEXT\"),",
					"        }",
					"        };",
					"",
					"        const bundle = pm.sendRequest( getRequest, (error, response) => {",
					"            if (error) {",
					"                    console.log(error);",
					"                } else {",
					"                    // console.log(response.json());",
					"",
					"                    if (response.json().total >= 1) {",
					"                        throw new Error(\"Resource already exists at \" + url);",
					"                } ",
					"",
					"                }",
					"            }",
					"        );",
					"    },",
					"    getIgSeedData: function(pm, resourceType, identifier) {",
					"        const url = `https://build.fhir.org/ig/tewhatuora/cinc-fhir-ig/${resourceType}-${identifier}.json`;",
					"        const seedDataRequest = {",
					"        url,",
					"        method: 'GET',",
					"        };",
					"",
					"        pm.sendRequest( seedDataRequest, (error, response) => {",
					"            if (error) {",
					"                console.log(\"Error\", error);",
					"                return \"Error: \" + JSON.stringify(error);",
					"            } else {",
					"                let resourceBody = response.json();",
					"                console.log(\"Response\", resourceBody);",
					"                delete resourceBody.text;",
					"                delete resourceBody.id;",
					"                resourceBody.resourceType = resourceType;",
					"                pm.variables.set('ResourceBody', JSON.stringify(resourceBody));",
					"            }",
					"        });",
					"    }",
					"}",
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	]
}